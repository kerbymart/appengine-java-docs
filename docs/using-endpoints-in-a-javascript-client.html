<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-07-13T01:56:45.52737875"><title>Using Endpoints in a JavaScript Client | Google App Engine Java Documentation</title><script type="application/json" id="virtual-toc-data">[{"id":"enabling-a-javascript-client-for-endpoints","level":0,"title":"Enabling a JavaScript client for Endpoints","anchor":"#enabling-a-javascript-client-for-endpoints"},{"id":"calling-an-endpoint-api","level":0,"title":"Calling an Endpoint API","anchor":"#calling-an-endpoint-api"},{"id":"adding-authentication-support-with-oauth-2-0","level":0,"title":"Adding authentication support with OAuth 2.0","anchor":"#adding-authentication-support-with-oauth-2-0"},{"id":"testing-a-javascript-client-against-a-local-development-server","level":0,"title":"Testing a JavaScript client against a local development server","anchor":"#testing-a-javascript-client-against-a-local-development-server"},{"id":"sample-client-source-code","level":0,"title":"Sample client source code","anchor":"#sample-client-source-code"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Using Endpoints in a JavaScript Client | Google App Engine Java Documentation"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Google App Engine Java Documentation Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/using-endpoints-in-a-javascript-client.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Using Endpoints in a JavaScript Client | Google App Engine Java Documentation"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/using-endpoints-in-a-javascript-client.html#webpage",
    "url": "writerside-documentation/using-endpoints-in-a-javascript-client.html",
    "name": "Using Endpoints in a JavaScript Client | Google App Engine Java Documentation",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Google App Engine Java Documentation Help"
}</script><!-- End Schema.org --></head><body data-id="Using-Endpoints-in-a-JavaScript-Client" data-main-title="Using Endpoints in a JavaScript Client" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Guides.md|Guides///Mobile-Backends.md|Mobile Backends///Using-Endpoints-in-Clients.md|Using Endpoints in Clients"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Google App Engine Java Documentation  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Using-Endpoints-in-a-JavaScript-Client" id="Using-Endpoints-in-a-JavaScript-Client.md">Using Endpoints in a JavaScript Client</h1><ol class="list _decimal" id="z5juw8u_3" type="1"><li class="list__item" id="z5juw8u_10"><p id="z5juw8u_15"><span id="z5juw8u_16">Enabling a JavaScript client for Endpoints</span></p></li><li class="list__item" id="z5juw8u_11"><p id="z5juw8u_17"><span id="z5juw8u_18">Calling an Endpoint API</span></p></li><li class="list__item" id="z5juw8u_12"><p id="z5juw8u_19"><span id="z5juw8u_21">Adding authentication support with OAuth 2.0</span></p><ol class="list _decimal" id="z5juw8u_20" type="1"><li class="list__item" id="z5juw8u_22"><p id="z5juw8u_24"><span id="z5juw8u_25">Sample auth flow for a JavaScript client</span></p></li><li class="list__item" id="z5juw8u_23"><p id="z5juw8u_26"><span id="z5juw8u_27">Signing out</span></p></li></ol></li><li class="list__item" id="z5juw8u_13"><p id="z5juw8u_28"><span id="z5juw8u_29">Testing a JavaScript client against a local development server</span></p></li><li class="list__item" id="z5juw8u_14"><p id="z5juw8u_30"><span id="z5juw8u_31">Sample client source code</span></p></li></ol><p id="z5juw8u_4">To use a Google Cloud Endpoint, you'll need to use the <a href="https://web.archive.org/web/20160424225905/https://developers.google.com/api-client-library/javascript/reference/referencedocs" id="z5juw8u_32" data-external="true" rel="noopener noreferrer" target="_blank">Google JavaScript client library</a>. The code you need to add to use Endpoints is minimal, as shown in the following sections.</p><section class="chapter"><h2 id="enabling-a-javascript-client-for-endpoints" data-toc="enabling-a-javascript-client-for-endpoints">Enabling a JavaScript client for Endpoints</h2><p id="z5juw8u_33">To enable a JavaScript client to use an Endpoint:</p><ol class="list _decimal" id="z5juw8u_34" type="1"><li class="list__item" id="z5juw8u_35"><p id="z5juw8u_39">Add the script that includes the Google-hosted JavaScript client library to your HTML:</p><div class="code-block" data-lang="none">
&lt;script src=&quot;https://apis.google.com/js/client.js?onload=init&quot;&gt;
&lt;/script&gt;
</div></li><li class="list__item" id="z5juw8u_36"><p id="z5juw8u_41">Notice that the JavaScript line above includes an <code class="code" id="z5juw8u_42">onload</code> property specifying the function to be used as a callback after the library loads. Replace &quot;init&quot; with the name of your page initialization function if you did not name it <code class="code" id="z5juw8u_43">init</code>.</p></li><li class="list__item" id="z5juw8u_37"><p id="z5juw8u_44">Inside your callback function, load your Endpoint:</p><div class="code-block" data-lang="none">
var ROOT = 'https://your_app_id.appspot.com/_ah/api';
gapi.client.load('your_api_name', 'v1', function() {
  doSomethingAfterLoading();
}, ROOT);
</div><p id="z5juw8u_46">This example loads <code class="code" id="z5juw8u_47">your_api_name v1</code> in the JavaScript client library and calls <code class="code" id="z5juw8u_48">doSomethingAfterLoading</code> once the API is loaded.</p></li><li class="list__item" id="z5juw8u_38"><p id="z5juw8u_49">Replace <code class="code" id="z5juw8u_50">ROOT</code> in the above code with the name of your application to load your own APIs. Replace <code class="code" id="z5juw8u_51">your_api_name</code> and <code class="code" id="z5juw8u_52">v1</code> with the name and version of your Endpoint.</p></li></ol></section><section class="chapter"><h2 id="calling-an-endpoint-api" data-toc="calling-an-endpoint-api">Calling an Endpoint API</h2><p id="z5juw8u_53">Once the JavaScript client is enabled for an Endpoint, you can make calls to that Endpoint using the Google JavaScript client object <code class="code" id="z5juw8u_57">gapi.client</code>. (For more information, see <a href="https://web.archive.org/web/20160424225905/https://developers.google.com/api-client-library/javascript/start/start-js" id="z5juw8u_58" data-external="true" rel="noopener noreferrer" target="_blank">Getting Started</a> for the google-api-javascript-client.)</p><p id="z5juw8u_54">The following two calls show an insert and a list request made to the Tic Tac Toe API:</p><div class="code-block" data-lang="none">
// Insert a score
gapi.client.tictactoe.scores.insert({'outcome':
    'WON'}).execute(function(resp) {
  console.log(resp);
});

// Get the list of previous scores
gapi.client.tictactoe.scores.list().execute(function(resp) {
  console.log(resp);
});
</div><p id="z5juw8u_56">During development you may want to use the Chrome developer tools JavaScript console, which automatically suggests available method names when you are manipulating <code class="code" id="z5juw8u_59">gapi.client</code>. With the above example Endpoint, typing <code class="code" id="z5juw8u_60">gapi.client.tictactoe.</code> into that console results in the Chrome developer tools suggesting <code class="code" id="z5juw8u_61">scores</code> as a possible completion.</p></section><section class="chapter"><h2 id="adding-authentication-support-with-oauth-2-0" data-toc="adding-authentication-support-with-oauth-2-0">Adding authentication support with OAuth 2.0</h2><p id="z5juw8u_62">Built-in support for OAuth is provided by the JavaScript client library for use with Google APIs and Endpoints.</p><p id="z5juw8u_63">Authorization is provided by the built-in <code class="code" id="z5juw8u_69">authorize</code> method. When you want to require a user sign-in, you call the following:</p><div class="code-block" data-lang="none">
gapi.auth.authorize({client_id: CLIENT_ID, scope: SCOPES,
    immediate: mode}, callback);
</div><p id="z5juw8u_65">where</p><ul class="list _bullet" id="z5juw8u_66"><li class="list__item" id="z5juw8u_70"><p id="z5juw8u_74"><code class="code" id="z5juw8u_75">CLIENT_ID</code> is the client ID of your application, specified in the <code class="code" id="z5juw8u_76">clientIds</code> attribute of the <code class="code" id="z5juw8u_77">@Api</code> (or <code class="code" id="z5juw8u_78">@ApiMethod</code>) annotation. For more information on getting client IDs, see <a href="https://web.archive.org/web/20160424225905/https://cloud.google.com/appengine/docs/java/endpoints/auth" id="z5juw8u_79" data-external="true" rel="noopener noreferrer" target="_blank">Adding Authentication to Endpoints</a>.</p></li><li class="list__item" id="z5juw8u_71"><p id="z5juw8u_80"><code class="code" id="z5juw8u_81">SCOPES</code> are the list of OAuth 2.0 scopes that must be granted to tokens sent to your backend. At minimum, you should request access to the userinfo.email scope: <code class="code" id="z5juw8u_82">https://www.googleapis.com/auth/userinfo.email</code> which grants access to the user&rsquo;s email address.</p></li><li class="list__item" id="z5juw8u_72"><p id="z5juw8u_83"><code class="code" id="z5juw8u_84">mode</code> is either <code class="code" id="z5juw8u_85">false</code> or <code class="code" id="z5juw8u_86">true</code>, depending on whether or not you&rsquo;d like to present the explicit authorization window to the user. If the user has never authorized your application before, calling authorize with <code class="code" id="z5juw8u_87">mode: true</code> (no authorization window) will fail. The correct situation to use each modes is described below.</p></li><li class="list__item" id="z5juw8u_73"><p id="z5juw8u_88"><code class="code" id="z5juw8u_89">callback</code> is the callback function to call once <code class="code" id="z5juw8u_90">authorize</code> completes.</p></li></ul><section class="chapter"><h3 id="sample-auth-flow-for-a-javascript-client" data-toc="sample-auth-flow-for-a-javascript-client">Sample auth flow for a JavaScript client</h3><p id="z5juw8u_91">Here&rsquo;s an example flow for authorizing a user in a page using the JS client:</p><div class="code-block" data-lang="none">
function init() {
  var apisToLoad;
  var loadCallback = function() {
    if (--apisToLoad == 0) {
      signin(true, userAuthed);
    }
  };

  apisToLoad = 2; // must match number of calls to gapi.client.load()
  apiRoot = '//' + window.location.host + '/_ah/api';
  gapi.client.load('tictactoe', 'v1', loadCallback, apiRoot);
  gapi.client.load('oauth2', 'v2', loadCallback);
}

function signin(mode, authorizeCallback) {
  gapi.auth.authorize({client_id: CLIENT_ID,
    scope: SCOPES, immediate: mode},
    authorizeCallback);
}

function userAuthed() {
  var request =
      gapi.client.oauth2.userinfo.get().execute(function(resp) {
    if (!resp.code) {
      // User is signed in, call my Endpoint
    }
  });
}
</div><p id="z5juw8u_93">Note that the code sample assumes <code class="code" id="z5juw8u_97">init()</code> to be the callback function you provided when loading the JS client library. Inside <code class="code" id="z5juw8u_98">init()</code>, your API and the OAuth 2.0 API are loaded. After the OAuth 2.0 API is loaded, the sample attempts to authorize the user using immediate mode (no authorization prompt). If immediate mode succeeds, the sample sets the token for future requests to the ID token required by your Endpoint's backend.</p><p id="z5juw8u_94">If your user has previously authorized your application, the user is signed in, and your application can proceed normally. Authorization headers are automatically supplied with any requests.</p><p id="z5juw8u_95">If the user has not authorized your application previously (or there is no signed in user in the browser session), you&rsquo;ll need to call authorize again, without using immediate mode. Because this method triggers a popup, it must be called as a result of a user action in the browser, such as clicking a link or button:</p><div class="code-block" data-lang="none">
&lt;a href=&quot;#&quot; onclick=&quot;auth();&quot; id=&quot;signinButton&quot;&gt;Sign in!&lt;/a&gt;

function auth() {
  signin(false, userAuthed);
};
</div></section><section class="chapter"><h3 id="signing-out" data-toc="signing-out">Signing out</h3><p id="z5juw8u_99">There is no concept of signing out using the JS client library, but you can emulate the behavior if you wish by any of these methods:</p><ul class="list _bullet" id="z5juw8u_100"><li class="list__item" id="z5juw8u_101"><p id="z5juw8u_104">Resetting the UI to the pre signed-in state.</p></li><li class="list__item" id="z5juw8u_102"><p id="z5juw8u_105">Setting any signed-in variables in your application logic to false</p></li><li class="list__item" id="z5juw8u_103"><p id="z5juw8u_106">Calling <code class="code" id="z5juw8u_107">gapi.auth.setToken(null);</code></p></li></ul></section></section><section class="chapter"><h2 id="testing-a-javascript-client-against-a-local-development-server" data-toc="testing-a-javascript-client-against-a-local-development-server">Testing a JavaScript client against a local development server</h2><p id="z5juw8u_108">You can test your client against a backend API running in production App Engine at any time without making any changes. However, if you want to test your client against a backend API running on the local development server, you'll need to change the javascript origin in the backend API's web client ID.</p><p id="z5juw8u_109">To make the required changes and test using the local dev server:</p><ol class="list _decimal" id="z5juw8u_110" type="1"><li class="list__item" id="z5juw8u_112"><p id="z5juw8u_117">Open the <a href="https://web.archive.org/web/20160424225905/https://console.cloud.google.com/project/_/apiui/credential" id="z5juw8u_118" data-external="true" rel="noopener noreferrer" target="_blank">Credentials page</a> for your project.</p></li><li class="list__item" id="z5juw8u_113"><p id="z5juw8u_119">Double-click on your OAuth 2.0 Web client in the client ID list.</p></li><li class="list__item" id="z5juw8u_114"><p id="z5juw8u_120">In the web client ID form, change the <span class="control" id="z5juw8u_121">Authorized JavaScript origins</span> field to <code class="code" id="z5juw8u_122">http://localhost:8080</code>.</p></li><li class="list__item" id="z5juw8u_115"><p id="z5juw8u_123">Start the local development server, as described in <a href="https://web.archive.org/web/20160424225905/https://cloud.google.com/appengine/docs/java/endpoints/test_deploy#running_and_testing_api_backends_locally" id="z5juw8u_125" data-external="true" rel="noopener noreferrer" target="_blank">Running and testing API backends locally</a>.</p><p id="z5juw8u_124">Make sure you don't change the default port, which is <code class="code" id="z5juw8u_126">8080</code>, because this is what you used to set the authorized JavaScript origins previously. (You can change the port if you wish, so long as the authorized JavaScript origins and the local dev server are both set to the same port.)</p></li><li class="list__item" id="z5juw8u_116"><p id="z5juw8u_127">Test your client as desired.</p></li></ol><p id="z5juw8u_111"><span class="control" id="z5juw8u_128">Important:</span> If the backend API is Auth-protected, your client must provide support as described above under <span id="z5juw8u_129">Adding Authentication Support with OAuth 2.0</span>. However, when running against the local dev server, no credentials page is displayed in response to a user's attempt to sign in. Instead, the sign-on simply occurs, granting the user access to the protected API, <span class="emphasis" id="z5juw8u_130">and the user returned is always <code class="code" id="z5juw8u_131">example@example.com</code></span>.</p></section><section class="chapter"><h2 id="sample-client-source-code" data-toc="sample-client-source-code">Sample client source code</h2><p id="z5juw8u_132">For a sample backend API and JavaScript client that illustrates the concepts described above, see the <a href="https://web.archive.org/web/20160424225905/https://github.com/GoogleCloudPlatform/appengine-endpoints-helloendpoints-java-maven" id="z5juw8u_133" data-external="true" rel="noopener noreferrer" target="_blank">Hello Endpoints</a> sample.</p></section><div class="last-modified">10 April 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="using-endpoints-in-clients.html" class="navigation-links__prev">Using Endpoints in Clients</a><a href="using-endpoints-in-an-android-client.html" class="navigation-links__next">Using Endpoints in an Android Client</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>