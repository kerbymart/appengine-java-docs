<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-07-13T01:56:44.310255811"><title>Java Datastore Index Configuration | Google App Engine Java Documentation</title><script type="application/json" id="virtual-toc-data">[{"id":"about-datastore-indexes-xml","level":0,"title":"About datastore-indexes.xml","anchor":"#about-datastore-indexes-xml"},{"id":"using-automatic-index-configuration","level":0,"title":"Using automatic index configuration","anchor":"#using-automatic-index-configuration"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Java Datastore Index Configuration | Google App Engine Java Documentation"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Google App Engine Java Documentation Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/java-datastore-index-configuration.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Java Datastore Index Configuration | Google App Engine Java Documentation"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/java-datastore-index-configuration.html#webpage",
    "url": "writerside-documentation/java-datastore-index-configuration.html",
    "name": "Java Datastore Index Configuration | Google App Engine Java Documentation",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Google App Engine Java Documentation Help"
}</script><!-- End Schema.org --></head><body data-id="Java-Datastore-Index-Configuration" data-main-title="Java Datastore Index Configuration" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Guides.md|Guides///Storing-Data.md|Storing Data///Google-Cloud-Datastore.md|Google Cloud Datastore"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Google App Engine Java Documentation  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Java-Datastore-Index-Configuration" id="Java-Datastore-Index-Configuration.md">Java Datastore Index Configuration</h1><p id="sp4jzn_3">The App Engine Datastore uses <a href="https://web.archive.org/web/20160424230308/https://cloud.google.com/appengine/docs/java/datastore/indexes" id="sp4jzn_7" data-external="true" rel="noopener noreferrer" target="_blank">indexes</a> for every query your application makes. These indexes are updated whenever an entity changes, so the results can be returned quickly when the app makes a query. To do this, the datastore needs to know in advance which queries the application will make. You specify which indexes your app needs in a configuration file. The development server can generate the datastore index configuration automatically as you test your app.</p><ol class="list _decimal" id="sp4jzn_4" type="1"><li class="list__item" id="sp4jzn_8"><p id="sp4jzn_10"><span id="sp4jzn_11">About datastore-indexes.xml</span></p></li><li class="list__item" id="sp4jzn_9"><p id="sp4jzn_12"><span id="sp4jzn_13">Using automatic index configuration</span></p></li></ol><section class="chapter"><h2 id="about-datastore-indexes-xml" data-toc="about-datastore-indexes-xml">About datastore-indexes.xml</h2><p id="sp4jzn_14">You specify configuration for datastore indexes in <code class="code" id="sp4jzn_21">WEB-INF/datastore-indexes.xml</code>, in your app's <code class="code" id="sp4jzn_22">war/</code> directory. This is an XML file whose root element is <code class="code" id="sp4jzn_23">&lt;datastore-indexes&gt;</code>. It contains zero or more <code class="code" id="sp4jzn_24">&lt;datastore-index&gt;</code> elements, one for each index that the Datastore should maintain.</p><p id="sp4jzn_15">As described on the <a href="https://web.archive.org/web/20160424230308/https://cloud.google.com/appengine/docs/java/datastore/indexes" id="sp4jzn_25" data-external="true" rel="noopener noreferrer" target="_blank">Datastore Indexes</a> page, an index is a table of values for a set of given properties for entities of a given kind. Each column of property values is sorted either in ascending or descending order. Configuration for an index specifies the kind of the entities, and the names of the properties and their sort orders.</p><p id="sp4jzn_16">Here is an example that specifies two indexes:</p><div class="code-block" data-lang="none">
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;datastore-indexes
  autoGenerate=&quot;true&quot;&gt;
    &lt;datastore-index kind=&quot;Employee&quot; ancestor=&quot;false&quot;&gt;
        &lt;property name=&quot;lastName&quot; direction=&quot;asc&quot; /&gt;
        &lt;property name=&quot;hireDate&quot; direction=&quot;desc&quot; /&gt;
    &lt;/datastore-index&gt;
    &lt;datastore-index kind=&quot;Project&quot; ancestor=&quot;false&quot;&gt;
        &lt;property name=&quot;dueDate&quot; direction=&quot;asc&quot; /&gt;
        &lt;property name=&quot;cost&quot; direction=&quot;desc&quot; /&gt;
    &lt;/datastore-index&gt;
&lt;/datastore-indexes&gt;
</div><p id="sp4jzn_18">The <code class="code" id="sp4jzn_26">&lt;datastore-indexes&gt;</code> element has an <code class="code" id="sp4jzn_27">autoGenerate</code> attribute that controls whether this file should be considered along with automatically generated index configuration. See <span id="sp4jzn_28">Using Automatic Index Configuration</span> below.</p><p id="sp4jzn_19">Each <code class="code" id="sp4jzn_29">&lt;datastore-index&gt;</code> element represents an index. The <code class="code" id="sp4jzn_30">kind</code> attribute specifies the kind of the entities to index. The <code class="code" id="sp4jzn_31">ancestor</code> attribute is <code class="code" id="sp4jzn_32">true</code> if the index supports queries that filter by ancestor-key to constrain results to a single entity group, <code class="code" id="sp4jzn_33">false</code> otherwise.</p><p id="sp4jzn_20">The <code class="code" id="sp4jzn_34">&lt;property&gt;</code> elements in a <code class="code" id="sp4jzn_35">&lt;datastore-index&gt;</code> represent the entity properties to index. The <code class="code" id="sp4jzn_36">name</code> attribute is the property name, and the <code class="code" id="sp4jzn_37">direction</code> attribute is the sort order, either <code class="code" id="sp4jzn_38">asc</code> for ascending or <code class="code" id="sp4jzn_39">desc</code> for descending. The order of the property elements specifies the order in the index: rows are sorted by the first property, then the second property, and so on.</p></section><section class="chapter"><h2 id="using-automatic-index-configuration" data-toc="using-automatic-index-configuration">Using automatic index configuration</h2><p id="sp4jzn_40">Determining the indexes required by your application's queries manually can be tedious and error-prone. Thankfully, the development server can determine the index configuration for you. To use automatic index configuration, add the attribute <code class="code" id="sp4jzn_45">autoGenerate=&quot;true&quot;</code> to your <code class="code" id="sp4jzn_46">WEB-INF/datastore-indexes.xml</code> file's <code class="code" id="sp4jzn_47">&lt;datastore-indexes&gt;</code> element. Automatic index configuration is also used if your app does not have a <code class="code" id="sp4jzn_48">datastore-indexes.xml</code> file.</p><p id="sp4jzn_41">With automatic index configuration enabled, the development server maintains a file named <code class="code" id="sp4jzn_49">WEB-INF/appengine-generated/datastore-indexes-auto.xml</code> in your app's <code class="code" id="sp4jzn_50">war/</code> directory. When your app, running in the development server, attempts a datastore query for which there is no corresponding index in either <code class="code" id="sp4jzn_51">datastore-indexes.xml</code> or <code class="code" id="sp4jzn_52">datastore-indexes-auto.xml</code>, the server adds the appropriate configuration to <code class="code" id="sp4jzn_53">datastore-indexes-auto.xml</code>.</p><p id="sp4jzn_42">If automatic index configuration is enabled when you upload your application, AppCfg uses both <code class="code" id="sp4jzn_54">datastore-indexes.xml</code> and <code class="code" id="sp4jzn_55">datastore-indexes-auto.xml</code> to determine which indexes need to be built for your app in production.</p><p id="sp4jzn_43">If <code class="code" id="sp4jzn_56">autoGenerate=&quot;false&quot;</code> is in your <code class="code" id="sp4jzn_57">datastore-indexes.xml</code>, the development server and <code class="code" id="sp4jzn_58">AppCfg</code> ignore the contents of <code class="code" id="sp4jzn_59">datastore-indexes-auto.xml</code>. If the app running locally performs a query whose index is not specified in <code class="code" id="sp4jzn_60">datastore-indexes.xml</code>, the development server throws an exception, just as the production Datastore would.</p><p id="sp4jzn_44">It's a good idea to occasionally move index configuration from <code class="code" id="sp4jzn_61">datastore-indexes-auto.xml</code> to <code class="code" id="sp4jzn_62">datastore-indexes.xml</code>, then disable automatic index configuration and test your app in the development server. This makes it easy to maintain indexes without having to manage two files, and ensures that your testing will reproduce errors caused by missing index configuration.</p></section><div class="last-modified">10 April 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="managing-datastore-from-the-google-cloud-platform-console.html" class="navigation-links__prev">Managing Datastore from the Google Cloud Platform Console</a><a href="using-google-cloud-sql.html" class="navigation-links__next">Using Google Cloud SQL</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>