<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-07-13T01:56:48.254542248"><title>Routing Requests to Modules | Google App Engine Java Documentation</title><script type="application/json" id="virtual-toc-data">[{"id":"routing-via-url","level":0,"title":"Routing via URL","anchor":"#routing-via-url"},{"id":"routing-with-a-dispatch-file","level":0,"title":"Routing with a dispatch file","anchor":"#routing-with-a-dispatch-file"},{"id":"routing-in-the-development-server","level":0,"title":"Routing in the development server","anchor":"#routing-in-the-development-server"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Routing Requests to Modules | Google App Engine Java Documentation"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Google App Engine Java Documentation Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/routing-requests-to-modules.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Routing Requests to Modules | Google App Engine Java Documentation"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/routing-requests-to-modules.html#webpage",
    "url": "writerside-documentation/routing-requests-to-modules.html",
    "name": "Routing Requests to Modules | Google App Engine Java Documentation",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Google App Engine Java Documentation Help"
}</script><!-- End Schema.org --></head><body data-id="Routing-Requests-to-Modules" data-main-title="Routing Requests to Modules" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Concepts.md|Concepts"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Google App Engine Java Documentation  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Routing-Requests-to-Modules" id="Routing-Requests-to-Modules.md">Routing Requests to Modules</h1><p id="z33iiu_3">HTTP requests from users can reach the appropriate module/version/instance in two ways: A request with a URL that ends at the domain level can be routed according to App Engine's default address routing rules. Alternatively, you can include a dispatch file that routes specific URL patterns according to your own rules.</p><p id="z33iiu_4">If you test your app using the <a href="https://web.archive.org/web/20160424230701/https://cloud.google.com/appengine/docs/java/tools/devserver" id="z33iiu_9" data-external="true" rel="noopener noreferrer" target="_blank">development server</a> the available routing and dispatch features are slightly different. To programmatically create URLs that work with both production and development servers, use the <a href="https://web.archive.org/web/20160424230701/https://cloud.google.com/appengine/docs/java/javadoc/com/google/appengine/api/modules/ModulesService#getVersionHostname(java.lang.String,%20java.lang.String,%20int)" id="z33iiu_10" data-external="true" rel="noopener noreferrer" target="_blank"><code class="code" id="z33iiu_12">ModulesService.getVersionHostname</code></a> method. See <span id="z33iiu_11">routing in the development server</span> to learn more.</p><ol class="list _decimal" id="z33iiu_5" type="1"><li class="list__item" id="z33iiu_13"><p id="z33iiu_16"><span id="z33iiu_18">Routing via URL</span></p><ol class="list _decimal" id="z33iiu_17" type="1"><li class="list__item" id="z33iiu_19"><p id="z33iiu_22"><span id="z33iiu_23">Default module</span></p></li><li class="list__item" id="z33iiu_20"><p id="z33iiu_24"><span id="z33iiu_25">Soft routing</span></p></li><li class="list__item" id="z33iiu_21"><p id="z33iiu_26"><span id="z33iiu_27">Restricting access to a module</span></p></li></ol></li><li class="list__item" id="z33iiu_14"><p id="z33iiu_28"><span id="z33iiu_30">Routing with a dispatch file</span></p><ol class="list _decimal" id="z33iiu_29" type="1"><li class="list__item" id="z33iiu_31"><p id="z33iiu_32"><span id="z33iiu_33">Uploading the dispatch file</span></p></li></ol></li><li class="list__item" id="z33iiu_15"><p id="z33iiu_34"><span id="z33iiu_36">Routing in the development server</span></p><ol class="list _decimal" id="z33iiu_35" type="1"><li class="list__item" id="z33iiu_37"><p id="z33iiu_39"><span id="z33iiu_40">Discovering instance addresses</span></p></li><li class="list__item" id="z33iiu_38"><p id="z33iiu_41"><span id="z33iiu_42">Dispatch files</span></p></li></ol></li></ol><section class="chapter"><h2 id="routing-via-url" data-toc="routing-via-url">Routing via URL</h2><p id="z33iiu_43">You can target an HTTP request with varying degrees of specificity. In the following examples appspot.com can be replaced with your app's custom domain if you have one. The URL substrings &quot;instance&quot;, &quot;version&quot;, &quot;module&quot;, and &quot;app-id&quot; represent application and module attributes that you have defined yourself.</p><p id="z33iiu_44"><span class="control" id="z33iiu_60">Note:</span> Google <a href="https://web.archive.org/web/20160424230701/http://googleonlinesecurity.blogspot.com/2014/08/https-as-ranking-signal_6.html" id="z33iiu_61" data-external="true" rel="noopener noreferrer" target="_blank">recommends</a> using the HTTPS protocol to send requests to your app. Google does not issue SSL certificates for double-wildcard domains hosted at <code class="code" id="z33iiu_62">appspot.com</code>. Therefore with HTTPS you must use the string &quot;-dot-&quot; instead of &quot;.&quot; to separate subdomains, as shown in the examples below. You can use a simple &quot;.&quot; with your own custom domain or with HTTP addresses.</p><p id="z33iiu_45">These address forms are guaranteed to reach their target (if it exists). They will never be intercepted and rerouted by a pattern in the dispatch file:</p><p id="z33iiu_46"><code class="code" id="z33iiu_63">https://instance-dot-version-dot-module-dot-app-id.appspot.com</code></p><p id="z33iiu_47"><code class="code" id="z33iiu_64">http://instance.version.module.app-id.my-custom-domain.com</code><br> Sends the request to the named module, version, and instance.</p><p id="z33iiu_48"><code class="code" id="z33iiu_66">https://version-dot-module-dot-app-id.appspot.com</code></p><p id="z33iiu_49"><code class="code" id="z33iiu_67">http://version.module.app-id.my-custom-domain.com</code><br> Sends the request to an available instance of the named module and version.</p><p id="z33iiu_50">These address forms have a default routing behavior. Note that the default routing is overridden if there is a matching pattern in the dispatch file:</p><p id="z33iiu_51"><code class="code" id="z33iiu_69">https://module-dot-app-id.appspot.com</code></p><p id="z33iiu_52"><code class="code" id="z33iiu_70">http://module.app-id.my-custom-domain.com</code><br> Sends the request to an available instance of the default version of the named module.</p><p id="z33iiu_53"><code class="code" id="z33iiu_72">https://version-dot-app-id.appspot.com</code></p><p id="z33iiu_54"><code class="code" id="z33iiu_73">http://version.app-id.my-custom-domain.com</code><br> Sends the request to an available instance of the given version of the default module.</p><p id="z33iiu_55"><code class="code" id="z33iiu_75">https://app-id.appspot.com</code></p><p id="z33iiu_56"><code class="code" id="z33iiu_76">http://app-id.my-custom-domain.com</code><br> Sends the request to an available instance of the default version of the default module.</p><section class="chapter"><h3 id="default-module" data-toc="default-module">Default module</h3><p id="z33iiu_78">The default module is defined by explicitly giving a module the name &quot;default,&quot; or by not including the name parameter in the module's config file. Requests that specify no module or an invalid module are routed to the default module. You can designate a default version for a module, when appropriate, in the <a href="https://web.archive.org/web/20160424230701/https://console.cloud.google.com//project/_/appengine/versions" id="z33iiu_79" data-external="true" rel="noopener noreferrer" target="_blank">Google Cloud Platform Console versions</a> tab.</p></section><section class="chapter"><h3 id="soft-routing" data-toc="soft-routing">Soft routing</h3><p id="z33iiu_80">If a request matches the <code class="code" id="z33iiu_82">app-id.appspot</code> portion of the hostname, but includes a module, version, or instance name that does not exist, then the request is routed to the default version of the default module. Soft routing does not apply to custom domains; requests to them will return a 404 if the hostname is invalid.</p><p id="z33iiu_81"><span class="control" id="z33iiu_83">Note:</span> Version names should begin with a letter, to distinguish them from numeric instances which are always specified by a number. This avoids the ambiguity with URLs like <code class="code" id="z33iiu_84">123.my-module.appspot.com</code>, which can be interpreted two ways: If version &ldquo;123&rdquo; exists, the target will be version &ldquo;123&rdquo; of the given module. If that version does not exist, the target will be instance number 123 of the default version of the module.</p></section><section class="chapter"><h3 id="restricting-access-to-a-module" data-toc="restricting-access-to-a-module">Restricting access to a module</h3><p id="z33iiu_85">All modules are public by default. If you want to restrict access to a module, add the &ldquo;login: admin&rdquo; parameter to its handlers.</p></section></section><section class="chapter"><h2 id="routing-with-a-dispatch-file" data-toc="routing-with-a-dispatch-file">Routing with a dispatch file</h2><p id="z33iiu_86">For certain URLs (described above), you can create a dispatch file that overrides the routing rules. This lets you send incoming requests to a specific module based on the path or hostname in the URL. For example, say that you want to route mobile requests like <code class="code" id="z33iiu_96">http://simple-sample.appspot.com/mobile/</code> to a mobile frontend, route worker requests like <code class="code" id="z33iiu_97">http://simple-sample.appspot.com/work/</code> to a static backend, and serve all static content from the default module.</p><p id="z33iiu_87">To do this you can create a custom routing with a <code class="code" id="z33iiu_98">dispatch.xml</code> file. The file should be placed in the WEB-INF directory of the default module.</p><div class="code-block" data-lang="none">
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;dispatch-entries&gt;
  &lt;dispatch&gt;
      &lt;!-- Default module serves the typical web resources and all static resources. --&gt;
      &lt;url&gt;*/favicon.ico&lt;/url&gt;
      &lt;module&gt;default&lt;/module&gt;
  &lt;/dispatch&gt;
  &lt;dispatch&gt;
      &lt;!-- Default module serves simple hostname request. --&gt;
      &lt;url&gt;simple-sample.appspot.com/&lt;/url&gt;
      &lt;module&gt;default&lt;/module&gt;
  &lt;/dispatch&gt;
  &lt;dispatch&gt;
      &lt;!-- Send all mobile traffic to the mobile frontend. --&gt;
      &lt;url&gt;*/mobile/*&lt;/url&gt;
      &lt;module&gt;mobile-frontend&lt;/module&gt;
  &lt;/dispatch&gt;
  &lt;dispatch&gt;
      &lt;!-- Send all work to the one static backend. --&gt;
      &lt;url&gt;*/work/*&lt;/url&gt;
      &lt;module&gt;static-backend&lt;/module&gt;
  &lt;/dispatch&gt;
&lt;/dispatch-entries&gt;
</div><p id="z33iiu_89">The dispatch file can contain up to 10 routing rules. When specifying the URL string, neither the hostname nor the path can be longer than 100 characters.</p><p id="z33iiu_90">As you can see, <code class="code" id="z33iiu_99">dispatch.xml</code> includes support for glob characters. Glob characters can be used only before the hostname and at the end of the path. If you prefer general routing rules that match many possible requests, you could specify the following:</p><div class="code-block" data-lang="none">
&lt;!-- Send any path that begins with simple-sample.appspot.com/mobile to the mobile-frontend module. --&gt;
&lt;url&gt;simple-sample.appspot.com/mobile*&lt;/url&gt;
&lt;module&gt;mobile-frontend&lt;/module&gt;

&lt;!-- Send any domain/sub-domain with a path that starts with work to the static backend module. --&gt;
&lt;url&gt;*/work*&lt;/url&gt;
&lt;module&gt;static-backend&lt;/module&gt;
</div><p id="z33iiu_92">You can also write expressions that are more strict:</p><div class="code-block" data-lang="none">
&lt;!-- Matches the path &quot;/fun&quot;, but not &quot;/fun2&quot; or &quot;/fun/other&quot;  --&gt;
&lt;url&gt;*/fun&lt;/url&gt;
&lt;module&gt;mobile-frontend&lt;/module&gt;

&lt;!-- Matches the hostname 'customer1.myapp.com', but not '1.customer1.myapp.com. --&gt;
&lt;url&gt;customer1.myapp.com/*&lt;/url&gt;
&lt;module&gt;static-backend&lt;/module&gt;
</div><p id="z33iiu_94"><span class="control" id="z33iiu_100">Note:</span> Dispatch rules apply to the URLs in a <a href="https://web.archive.org/web/20160424230701/https://cloud.google.com/appengine/docs/java/config/cron" id="z33iiu_101" data-external="true" rel="noopener noreferrer" target="_blank">cron file</a>.</p><section class="chapter"><h3 id="uploading-the-dispatch-file" data-toc="uploading-the-dispatch-file">Uploading the dispatch file</h3><p id="z33iiu_102">To upload the dispatch file, use the <a href="https://web.archive.org/web/20160424230701/https://cloud.google.com/appengine/docs/java/tools/uploadinganapp#Java_Updating_the_dispatch_file" id="z33iiu_106" data-external="true" rel="noopener noreferrer" target="_blank">appcfg update_dispatch</a> command, and specify the war directory for the default module. Be sure that all the modules mentioned in the file have already been uploaded before using this command.</p><div class="code-block" data-lang="none">
# cd to the war directory containing the default module
appcfg.sh update_dispatch .
</div><p id="z33iiu_104">You can also upload the dispatch file at the same time you upload one or more modules, by adding the optional <code class="code" id="z33iiu_107">auto_update_dispatch</code> flag, which can be used in two forms:</p><div class="code-block" data-lang="none">
appcfg.sh --auto_update_dispatch update &lt;app-directory&gt;|&lt;files...&gt;
appcfg.sh -D update &lt;app-directory&gt;|&lt;files...&gt;
</div></section></section><section class="chapter"><h2 id="routing-in-the-development-server" data-toc="routing-in-the-development-server">Routing in the development server</h2><section class="chapter"><h3 id="discovering-instance-addresses" data-toc="discovering-instance-addresses">Discovering instance addresses</h3><p id="z33iiu_110">The development server creates all instances at startup. Note that at this time basic scaling instances are not supported on the development server. Every instance that is created is assigned its own port. The port assignments appear in the server's log message stream. Web clients can communicate with a particular instance by targeting its port. Only one instance (and port) is created for automatic scaled modules. It looks like this in the server log:</p><div class="code-block" data-lang="none">
INFO: Module instance module2-auto is running at http://localhost:37251/
</div><p id="z33iiu_112">A unique port is assigned to each instance of a manual scaled module:</p><div class="code-block" data-lang="none">
INFO: Module instance manualmodule instance 0 is running at http://localhost:43190/
INFO: Module instance manualmodule instance 1 is running at http://localhost:52642/
</div><p id="z33iiu_114">In addition, each manual scaled module is assigned one extra port so clients can access the module without specifying a specific instance. Requests to this port are automatically routed to one of the configured instances:</p><div class="code-block" data-lang="none">
INFO: Module instance manualmodule is running at http://localhost:12361/
</div><p id="z33iiu_116">The following table shows how these modules can be called in the development server and in the App Engine environment:</p><div class="table-wrapper"><table class="wide" id="z33iiu_117"><thead><tr class="ijRowHead" id="z33iiu_118"><th id="z33iiu_123"><p>Module</p></th><th id="z33iiu_124"><p>Instance</p></th><th id="z33iiu_125"><p>Development Server Address</p></th><th id="z33iiu_126"><p>App Engine Address</p></th></tr></thead><tbody><tr id="z33iiu_119"><td id="z33iiu_127"><p>module2-auto</p></td><td id="z33iiu_128"><p>(not used)</p></td><td id="z33iiu_129"><p><code class="code" id="z33iiu_131">http://localhost:37251/</code></p></td><td id="z33iiu_130"><p><code class="code" id="z33iiu_132">http://v1.module2-auto.appid.appspot.com/</code></p></td></tr><tr id="z33iiu_120"><td id="z33iiu_133"><p>manualmodule</p></td><td id="z33iiu_134"><p>0</p></td><td id="z33iiu_135"><p><code class="code" id="z33iiu_137">http://localhost:43190/</code></p></td><td id="z33iiu_136"><p><code class="code" id="z33iiu_138">http://0.v1.manualmodule.appid.appspot.com/</code></p></td></tr><tr id="z33iiu_121"><td id="z33iiu_139"><p>manualmodule</p></td><td id="z33iiu_140"><p>1</p></td><td id="z33iiu_141"><p><code class="code" id="z33iiu_143">http://localhost:52642/</code></p></td><td id="z33iiu_142"><p><code class="code" id="z33iiu_144">http://1.v1.manualmodule.appid.appspot.com/</code></p></td></tr><tr id="z33iiu_122"><td id="z33iiu_145"><p>manualmodule</p></td><td id="z33iiu_146"><p>(not used)</p></td><td id="z33iiu_147"><p><code class="code" id="z33iiu_149">http://localhost:12361/</code></p></td><td id="z33iiu_148"><p><code class="code" id="z33iiu_150">http://v1.manualmodule.appid.appspot.com/</code></p></td></tr></tbody></table></div></section><section class="chapter"><h3 id="dispatch-files" data-toc="dispatch-files">Dispatch files</h3><p id="z33iiu_151">All dispatch files are ignored when running the development server. The only way to target instances is through their ports.</p></section></section><div class="last-modified">10 April 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="handling-requests.html" class="navigation-links__prev">Handling Requests</a><a href="how-applications-scale.html" class="navigation-links__next">How Applications Scale</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>