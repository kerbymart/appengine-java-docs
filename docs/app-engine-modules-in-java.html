<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-07-13T01:56:48.12570037"><title>App Engine Modules in Java | Google App Engine Java Documentation</title><script type="application/json" id="virtual-toc-data">[{"id":"application-hierarchy","level":0,"title":"Application hierarchy","anchor":"#application-hierarchy"},{"id":"scaling-types-and-instance-classes","level":0,"title":"Scaling types and instance classes","anchor":"#scaling-types-and-instance-classes"},{"id":"configuration","level":0,"title":"Configuration","anchor":"#configuration"},{"id":"uploading-and-deleting-modules","level":0,"title":"Uploading and deleting modules","anchor":"#uploading-and-deleting-modules"},{"id":"instance-states","level":0,"title":"Instance states","anchor":"#instance-states"},{"id":"instance-uptime","level":0,"title":"Instance uptime","anchor":"#instance-uptime"},{"id":"background-threads","level":0,"title":"Background threads","anchor":"#background-threads"},{"id":"monitoring-resource-usage","level":0,"title":"Monitoring resource usage","anchor":"#monitoring-resource-usage"},{"id":"logging","level":0,"title":"Logging","anchor":"#logging"},{"id":"communication-between-modules","level":0,"title":"Communication between modules","anchor":"#communication-between-modules"},{"id":"limits","level":0,"title":"Limits","anchor":"#limits"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="App Engine Modules in Java | Google App Engine Java Documentation"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Google App Engine Java Documentation Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/app-engine-modules-in-java.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="App Engine Modules in Java | Google App Engine Java Documentation"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/app-engine-modules-in-java.html#webpage",
    "url": "writerside-documentation/app-engine-modules-in-java.html",
    "name": "App Engine Modules in Java | Google App Engine Java Documentation",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Google App Engine Java Documentation Help"
}</script><!-- End Schema.org --></head><body data-id="App-Engine-Modules-in-Java" data-main-title="App Engine Modules in Java" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Concepts.md|Concepts"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Google App Engine Java Documentation  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="App-Engine-Modules-in-Java" id="App-Engine-Modules-in-Java.md">App Engine Modules in Java</h1><p id="-gy2rbs_3"><a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/python/modules/" id="-gy2rbs_24" data-tooltip="View this page in the Python runtime" data-external="true" rel="noopener noreferrer" target="_blank">Python</a> |Java |<a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/php/modules/" id="-gy2rbs_25" data-tooltip="View this page in the PHP runtime" data-external="true" rel="noopener noreferrer" target="_blank">PHP</a> |<a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/go/modules/" id="-gy2rbs_26" data-tooltip="View this page in the Go runtime" data-external="true" rel="noopener noreferrer" target="_blank">Go</a></p><p id="-gy2rbs_4"><a href="https://web.archive.org/web/20160425095823/http://stackoverflow.com/questions/tagged/google-app-engine+module" id="-gy2rbs_27" data-external="true" rel="noopener noreferrer" target="_blank"><figure id="-gy2rbs_28"><img alt="Stack overflow questions" src="https://web.archive.org/web/20160425095823im_/https://cloud.google.com/cloud/images/stack_overflow_questions.png" title="Stack Overflow Questions" width="240" height="53"></figure></a></p><p id="-gy2rbs_5"><a href="https://web.archive.org/web/20160425095823/http://stackoverflow.com/feeds/tag?sort=votes&amp;tagnames=google-app-engine%2Bmodule" id="-gy2rbs_29" data-external="true" rel="noopener noreferrer" target="_blank">https://web.archive.org/web/20160425095823/http://stackoverflow.com/feeds/tag?sort=votes&amp;tagnames=google-app-engine%2Bmodule</a></p><p id="-gy2rbs_6"></p><p id="-gy2rbs_7"><a href="https://web.archive.org/web/20160425095823/http://stackoverflow.com/questions/tagged/google-app-engine+module?sort=votes" id="-gy2rbs_30" data-external="true" rel="noopener noreferrer" target="_blank">See more...</a></p><p id="-gy2rbs_8">App Engine Modules (or just &quot;Modules&quot; hereafter) let developers factor large applications into logical components that can share stateful services and communicate in a secure fashion. A deployed module behaves like a <a href="https://web.archive.org/web/20160425095823/https://wikipedia.org/wiki/Microservices" id="-gy2rbs_31" data-external="true" rel="noopener noreferrer" target="_blank">microservice</a>. By using multiple modules you can <a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/solutions/microservices-on-app-engine" id="-gy2rbs_32" data-external="true" rel="noopener noreferrer" target="_blank">deploy your app as a set of microservices</a>, which is a popular design pattern.</p><p id="-gy2rbs_9">For example, an app that handles customer requests might include separate modules to handle other tasks, such as:</p><ul class="list _bullet" id="-gy2rbs_10"><li class="list__item" id="-gy2rbs_33"><p id="-gy2rbs_36">API requests from mobile devices</p></li><li class="list__item" id="-gy2rbs_34"><p id="-gy2rbs_37">Internal, admin-like requests</p></li><li class="list__item" id="-gy2rbs_35"><p id="-gy2rbs_38">Backend processing such as billing pipelines and data analysis</p></li></ul><p id="-gy2rbs_11">Modules can be configured to use different runtimes and to operate with different performance settings.</p><ol class="list _decimal" id="-gy2rbs_12" type="1"><li class="list__item" id="-gy2rbs_39"><p id="-gy2rbs_50"><span id="-gy2rbs_51">Application hierarchy</span></p></li><li class="list__item" id="-gy2rbs_40"><p id="-gy2rbs_52"><span id="-gy2rbs_53">Scaling types and instance classes</span></p></li><li class="list__item" id="-gy2rbs_41"><p id="-gy2rbs_54"><span id="-gy2rbs_55">Configuration</span></p></li><li class="list__item" id="-gy2rbs_42"><p id="-gy2rbs_56"><span id="-gy2rbs_57">Uploading and deleting modules</span></p></li><li class="list__item" id="-gy2rbs_43"><p id="-gy2rbs_58"><span id="-gy2rbs_59">Instance states</span></p></li><li class="list__item" id="-gy2rbs_44"><p id="-gy2rbs_60"><span id="-gy2rbs_61">Instance uptime</span></p></li><li class="list__item" id="-gy2rbs_45"><p id="-gy2rbs_62"><span id="-gy2rbs_63">Background threads</span></p></li><li class="list__item" id="-gy2rbs_46"><p id="-gy2rbs_64"><span id="-gy2rbs_65">Monitoring resource usage</span></p></li><li class="list__item" id="-gy2rbs_47"><p id="-gy2rbs_66"><span id="-gy2rbs_67">Logging</span></p></li><li class="list__item" id="-gy2rbs_48"><p id="-gy2rbs_68"><span id="-gy2rbs_69">Communication between modules</span></p></li><li class="list__item" id="-gy2rbs_49"><p id="-gy2rbs_70"><span id="-gy2rbs_71">Limits</span></p></li></ol><section class="chapter"><h2 id="application-hierarchy" data-toc="application-hierarchy">Application hierarchy</h2><p id="-gy2rbs_72">At the highest level, an App Engine application is made up of one or more <span class="emphasis" id="-gy2rbs_79">modules</span>. Each module consists of source code and configuration files. The files used by a module represent a <span class="emphasis" id="-gy2rbs_80">version</span> of the module. When you deploy a module, you always deploy a specific version of the module. For this reason, whenever we speak of a module, it usually means a version of a module.</p><p id="-gy2rbs_73">You can deploy multiple versions of the same module, to account for alternative implementations or progressive upgrades as time goes on.</p><p id="-gy2rbs_74">Each module and each version must have a name. A name can contain numbers, letters, and hyphens. It cannot be longer than 63 characters and cannot start or end with a hyphen. Choose a unique name for each module and each version. Don't reuse names between modules and versions.</p><p id="-gy2rbs_75">While running, a particular module/version will have one or more <span class="emphasis" id="-gy2rbs_81">instances</span>. Each instance runs its own separate executable. The number of instances running at any time depends on the module's scaling type and the amount of incoming requests:</p><figure id="-gy2rbs_76"><img alt="Hierarchy graph of modules/versions/instances" src="https://web.archive.org/web/20160425095823im_/https://cloud.google.com/appengine/docs/images/modules_hierarchy.png" title="Hierarchy graph of modules/versions/instances"></figure><p id="-gy2rbs_77">Stateful services (such as Memcache, Datastore, and Task Queues) are shared by all the modules in an application. Every module, version, and instance has its own unique URI (for example, <code class="code" id="-gy2rbs_82">v1.my-module.my-app.appspot.com</code>). Incoming user requests are routed to an instance of a particular module/version according to <a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/java/modules/routing" id="-gy2rbs_83" data-external="true" rel="noopener noreferrer" target="_blank">URL addressing conventions and an optional customized dispatch file</a>.</p><p id="-gy2rbs_78"><span class="control" id="-gy2rbs_84">Note:</span> After April 2013 Google does not issue SSL certificates for double-wildcard domains hosted at <code class="code" id="-gy2rbs_85">appspot.com</code> (i.e. <code class="code" id="-gy2rbs_86">*.*.appspot.com</code>). If you rely on such URLs for HTTPS access to your application, change any application logic to use &quot; <code class="code" id="-gy2rbs_87">-dot-</code> &quot; instead of &quot; <code class="code" id="-gy2rbs_88">.</code> &quot;. For example, to access version v1 of application myapp use <code class="code" id="-gy2rbs_89">https://v1-dot-myapp.appspot.com</code>. The certificate will not match if you use <code class="code" id="-gy2rbs_90">https://v1.myapp.appspot.com</code>, and an error occurs for any User-Agent that expects the URL and certificate to match exactly.</p></section><section class="chapter"><h2 id="scaling-types-and-instance-classes" data-toc="scaling-types-and-instance-classes">Scaling types and instance classes</h2><p id="-gy2rbs_91">When you upload a version of a module, the configuration file specifies a <span class="emphasis" id="-gy2rbs_99">scaling type</span> and <span class="emphasis" id="-gy2rbs_100">instance class</span> that apply to every instance of that version. The <span class="emphasis" id="-gy2rbs_101">scaling type</span> controls how instances are created. The instance class determines compute resources and pricing. There are three scaling types: <span class="emphasis" id="-gy2rbs_102">manual</span>, <span class="emphasis" id="-gy2rbs_103">basic</span>, and <span class="emphasis" id="-gy2rbs_104">automatic</span>. Available instance classes depend on the scaling type.</p><div class="table-wrapper"><table class="wide" id="-gy2rbs_92"><thead><tr class="ijRowHead" id="-gy2rbs_105"><th id="-gy2rbs_109"><p>Scaling Type</p></th><th id="-gy2rbs_110"><p>Description</p></th><th id="-gy2rbs_111"><p>Available&nbsp;Instance&nbsp;Classes</p></th></tr></thead><tbody><tr id="-gy2rbs_106"><td id="-gy2rbs_112"><p>Manual&nbsp;Scaling</p></td><td id="-gy2rbs_113"><p>A module with manual scaling runs continuously, allowing you to perform complex initialization and rely on the state of its memory over time.</p></td><td id="-gy2rbs_114"><p>B1, B2, B4, B4_1G, or B8</p></td></tr><tr id="-gy2rbs_107"><td id="-gy2rbs_115"><p>Basic&nbsp;Scaling</p></td><td id="-gy2rbs_116"><p>A module with basic scaling will create an instance when the application receives a request. The instance will be turned down when the app becomes idle. Basic scaling is ideal for work that is intermittent or driven by user activity.</p></td><td id="-gy2rbs_117"><p>B1, B2, B4, B4_1G, or B8</p></td></tr><tr id="-gy2rbs_108"><td id="-gy2rbs_118"><p>Automatic&nbsp;Scaling</p></td><td id="-gy2rbs_119"><p>Automatic scaling is based on request rate, response latencies, and other application metrics.</p></td><td id="-gy2rbs_120"><p>F1, F2, F4, or F4_1G</p></td></tr></tbody></table></div><p id="-gy2rbs_93">This table summarizes the CPU, memory, and hourly billing rate of the various instance classes.</p><div class="table-wrapper"><table class="wide" id="-gy2rbs_94"><thead><tr class="ijRowHead" id="-gy2rbs_121"><th id="-gy2rbs_131"><p>Instance Class</p></th><th id="-gy2rbs_132"><p>Memory Limit</p></th><th id="-gy2rbs_133"><p>CPU Limit</p></th><th id="-gy2rbs_134"><p>Cost per Hour per Instance</p></th></tr></thead><tbody><tr id="-gy2rbs_122"><td id="-gy2rbs_135"><p>B1</p></td><td id="-gy2rbs_136"><p>128 MB</p></td><td id="-gy2rbs_137"><p>600 Mhz</p></td><td id="-gy2rbs_138"><p>$0.05</p></td></tr><tr id="-gy2rbs_123"><td id="-gy2rbs_139"><p>B2</p></td><td id="-gy2rbs_140"><p>256 MB</p></td><td id="-gy2rbs_141"><p>1.2 Ghz</p></td><td id="-gy2rbs_142"><p>$0.10</p></td></tr><tr id="-gy2rbs_124"><td id="-gy2rbs_143"><p>B4</p></td><td id="-gy2rbs_144"><p>512 MB</p></td><td id="-gy2rbs_145"><p>2.4 Ghz</p></td><td id="-gy2rbs_146"><p>$0.20</p></td></tr><tr id="-gy2rbs_125"><td id="-gy2rbs_147"><p>B4_1G</p></td><td id="-gy2rbs_148"><p>1024 MB</p></td><td id="-gy2rbs_149"><p>2.4 Ghz</p></td><td id="-gy2rbs_150"><p>$0.30</p></td></tr><tr id="-gy2rbs_126"><td id="-gy2rbs_151"><p>B8</p></td><td id="-gy2rbs_152"><p>1024 MB</p></td><td id="-gy2rbs_153"><p>4.8 Ghz</p></td><td id="-gy2rbs_154"><p>$0.40</p></td></tr><tr id="-gy2rbs_127"><td id="-gy2rbs_155"><p>F1</p></td><td id="-gy2rbs_156"><p>128 MB</p></td><td id="-gy2rbs_157"><p>600 Mhz</p></td><td id="-gy2rbs_158"><p>$0.05</p></td></tr><tr id="-gy2rbs_128"><td id="-gy2rbs_159"><p>F2</p></td><td id="-gy2rbs_160"><p>256 MB</p></td><td id="-gy2rbs_161"><p>1.2 Ghz</p></td><td id="-gy2rbs_162"><p>$0.10</p></td></tr><tr id="-gy2rbs_129"><td id="-gy2rbs_163"><p>F4</p></td><td id="-gy2rbs_164"><p>512 MB</p></td><td id="-gy2rbs_165"><p>2.4 Ghz</p></td><td id="-gy2rbs_166"><p>$0.20</p></td></tr><tr id="-gy2rbs_130"><td id="-gy2rbs_167"><p>F4_1G</p></td><td id="-gy2rbs_168"><p>1024 MB</p></td><td id="-gy2rbs_169"><p>2.4 Ghz</p></td><td id="-gy2rbs_170"><p>$0.30</p></td></tr></tbody></table></div><p id="-gy2rbs_95">Instances running in manual and basic scaling modules are billed at hourly rates based on uptime. Billing begins when an instance starts and ends fifteen minutes after a manual instance shuts down or fifteen minutes after a basic instance has finished processing its last request. Runtime overhead is counted against the instance memory limit. This will be higher for Java than for other languages.</p><p id="-gy2rbs_96"><span class="control" id="-gy2rbs_171">Important:</span> When you are billed for instance hours, you will not see any instance classes in your billing line items. Instead, you will see the appropriate multiple of instance hours. For example, if you use an F4 instance for one hour, you do not see &quot;F4&quot; listed, but you will see billing for four instance hours at the F1 rate.</p><p id="-gy2rbs_97">This table compares the performance features of the three scaling types:</p><div class="table-wrapper"><table class="wide" id="-gy2rbs_98"><thead><tr class="ijRowHead" id="-gy2rbs_172"><th id="-gy2rbs_180"><p>Feature</p></th><th id="-gy2rbs_181"><p>Automatic Scaling</p></th><th id="-gy2rbs_182"><p>Manual Scaling</p></th><th id="-gy2rbs_183"><p>Basic Scaling</p></th></tr></thead><tbody><tr id="-gy2rbs_173"><td id="-gy2rbs_184"><p>Deadlines</p></td><td id="-gy2rbs_185"><p>60-second deadline for HTTP requests, 10-minute deadline for tasks</p></td><td id="-gy2rbs_186"><p>Requests can run indefinitely. A manually-scaled instance can choose to handle <code class="code" id="-gy2rbs_188">/_ah/start</code> and execute a program or script for many hours without returning an HTTP response code. Tasks can run up to 24 hours.</p></td><td id="-gy2rbs_187"><p>Same as manual scaling.</p></td></tr><tr id="-gy2rbs_174"><td id="-gy2rbs_189"><p>Background Threads</p></td><td id="-gy2rbs_190"><p>Not allowed</p></td><td id="-gy2rbs_191"><p>Allowed</p></td><td id="-gy2rbs_192"><p>Allowed</p></td></tr><tr id="-gy2rbs_175"><td id="-gy2rbs_193"><p>Residence</p></td><td id="-gy2rbs_194"><p>Instances are evicted from memory based on usage patterns.</p></td><td id="-gy2rbs_195"><p>Instances remain in memory, and state is preserved across requests. When instances are restarted, an <code class="code" id="-gy2rbs_197">/_ah/stop</code> request appears in the logs. If there is a registered stop callback method, it has 30 seconds to complete before shutdown occurs.</p></td><td id="-gy2rbs_196"><p>Instances are evicted based on the <code class="code" id="-gy2rbs_198">idle-timeout</code> parameter. If an instance has been idle, i.e. has not received a request, for more than <code class="code" id="-gy2rbs_199">idle-timeout</code>, then the instance is evicted.</p></td></tr><tr id="-gy2rbs_176"><td id="-gy2rbs_200"><p>Startup and Shutdown</p></td><td id="-gy2rbs_201"><p>Instances are created on demand to handle requests and automatically turned down when idle.</p></td><td id="-gy2rbs_202"><p>Instances are sent a start request automatically by App Engine in the form of an empty GET request to <code class="code" id="-gy2rbs_204">/_ah/start</code>. An instance that is stopped with <code class="code" id="-gy2rbs_205">appcfg stop</code> (or from the Cloud Platform Console) has 30 seconds to finish handling requests before it is forcibly terminated.</p></td><td id="-gy2rbs_203"><p>Instances are created on demand to handle requests and automatically turned down when idle, based on the <code class="code" id="-gy2rbs_206">idle-timeout</code> configuration parameter. As with manual scaling, an instance that is stopped with <code class="code" id="-gy2rbs_207">appcfg stop</code> (or from the Cloud Platform Console) has 30 seconds to finish handling requests before it is forcibly terminated.</p></td></tr><tr id="-gy2rbs_177"><td id="-gy2rbs_208"><p>Instance Addressability</p></td><td id="-gy2rbs_209"><p>Instances are anonymous.</p></td><td id="-gy2rbs_210"><p>Instance &quot;i&quot; of version &quot;v&quot; of module &quot;m&quot; is addressable at the URL: <code class="code" id="-gy2rbs_212">http://i.v.m.app_id.appspot.com</code>. If you have set up a <a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/java/console/using-custom-domains-and-ssl#wildcard_mappings" id="-gy2rbs_213" data-external="true" rel="noopener noreferrer" target="_blank">wildcard subdomain mapping</a> for a custom domain, you can also address a module or any of its instances via a URL of the form <code class="code" id="-gy2rbs_214">http://m.domain.com</code> or <code class="code" id="-gy2rbs_215">http://i.m.domain.com</code>. You can reliably cache state in each instance and retrieve it in subsequent requests.</p></td><td id="-gy2rbs_211"><p>Same as manual scaling.</p></td></tr><tr id="-gy2rbs_178"><td id="-gy2rbs_216"><p>Scaling</p></td><td id="-gy2rbs_217"><p>App Engine scales the number of instances automatically in response to processing volume. This scaling factors in the <code class="code" id="-gy2rbs_220">automatic_scaling</code> settings that are provided on a per-version basis in the configuration file uploaded with the module version.</p></td><td id="-gy2rbs_218"><p>You configure the number of instances of each module version in that module&rsquo;s configuration file. The number of instances usually corresponds to the size of a dataset being held in memory or the desired throughput for offline work.</p></td><td id="-gy2rbs_219"><p>A basic scaling module version is configured with a maximum number of instances using the <code class="code" id="-gy2rbs_221">basic_scaling</code> setting's <code class="code" id="-gy2rbs_222">max_instances</code> parameter. The number of live instances scales with the processing volume.</p></td></tr><tr id="-gy2rbs_179"><td id="-gy2rbs_223"><p>Free Daily Usage Quota</p></td><td id="-gy2rbs_224"><p>28 instance-hours</p></td><td id="-gy2rbs_225"><p>8 instance-hours</p></td><td id="-gy2rbs_226"><p>8 instance-hours</p></td></tr></tbody></table></div></section><section class="chapter"><h2 id="configuration" data-toc="configuration">Configuration</h2><p id="-gy2rbs_227">An App Engine application that uses modules is organized as an unpacked Java Enterprise Archive (EAR) directory structure. The top-level EAR directory contains a single META-INF subdirectory, and a separate directory for each module in the app. These module directories are organized as unpacked Java Web Application Archives (WAR). Each WAR directory usually has the same name as the module it defines, but this is not required. Although Java EE supports WAR files, module configuration uses unpacked WAR directories only. App Engine's Java SDK includes an <a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/java/tools/maven#creating_app_engine_applications_or_backend_apis_using_the_archetypes" id="-gy2rbs_236" data-external="true" rel="noopener noreferrer" target="_blank">Apache Maven plugin</a> with archetypes that you can use to build a skeletal EAR structure for you.</p><figure id="-gy2rbs_228"><img alt="Hierarchy graph of EAR directories" src="https://web.archive.org/web/20160425095823im_/https://cloud.google.com/appengine/docs/images/modules_file_hierarchy.png" title="Hierarchy graph of EAR directories"></figure><p id="-gy2rbs_229">The META-INF directory has two configuration files: <code class="code" id="-gy2rbs_237">appengine-application.xml</code> and <code class="code" id="-gy2rbs_238">application.xml</code>. The <code class="code" id="-gy2rbs_239">appengine-application.xml</code> file contains general information used by App Engine tools when your app is deployed. The <code class="code" id="-gy2rbs_240">application.xml</code> file declares the list of modules and their WAR directories that comprise the application. The WAR directory for each module contains two configuration files: <code class="code" id="-gy2rbs_241">appengine-web.xml</code>, and <code class="code" id="-gy2rbs_242">web.xml</code>.</p><p id="-gy2rbs_230">The WAR directory file <a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/java/config/appconfig" id="-gy2rbs_243" data-external="true" rel="noopener noreferrer" target="_blank">appengine-web.xml</a> defines the configuration of modules. Each module has its own file, which defines the <a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/java/config/appconfig#scaling_and_instance_types" id="-gy2rbs_244" data-external="true" rel="noopener noreferrer" target="_blank">scaling type and instance class</a> for a specific module/version. Different scaling parameters are used depending on which type of scaling you specify. If you do not specify scaling, automatic scaling is the default.</p><p id="-gy2rbs_231">Note that while every <code class="code" id="-gy2rbs_245">appengine-web.xml</code> file must contain the <code class="code" id="-gy2rbs_246">&lt;application&gt;</code> tag, the name you supply there is ignored. The name of the application is taken from the <code class="code" id="-gy2rbs_247">&lt;application&gt;</code> tag in the <code class="code" id="-gy2rbs_248">appengine-application.xml</code> file.</p><p id="-gy2rbs_232">For each module you can also specify settings that map URL requests to specific Java servlets and identify static files for better server efficiency. These settings are included in the <code class="code" id="-gy2rbs_249">web.xml</code> and <code class="code" id="-gy2rbs_250">appengine-web.xml</code> files and are described in the <a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/java/config/webxml" id="-gy2rbs_251" data-external="true" rel="noopener noreferrer" target="_blank">Deployment Descriptor</a> and <a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/java/config/appconfig" id="-gy2rbs_252" data-external="true" rel="noopener noreferrer" target="_blank">App Config</a> sections.</p><section class="chapter"><h3 id="the-default-module" data-toc="the-default-module">The default module</h3><p id="-gy2rbs_253">Every application has a single default module. The default module is defined by the standard <code class="code" id="-gy2rbs_255">appengine-web.xml</code> file or by an <code class="code" id="-gy2rbs_256">appengine-web.xml</code> with the setting <code class="code" id="-gy2rbs_257">&lt;module&gt;default&lt;/module&gt;</code>. All configuration parameters relevant to modules can apply to the default module.</p><p id="-gy2rbs_254">Also be sure to list the default module as the first module in the EAR directory's <code class="code" id="-gy2rbs_258">META-INF/application.xml</code> file, as shown in the example below.</p></section><section class="chapter"><h3 id="optional-configuration-files" data-toc="optional-configuration-files">Optional configuration files</h3><p id="-gy2rbs_259">These configuration files control optional features that apply to all the modules in an app:</p><ul class="list _bullet" id="-gy2rbs_260"><li class="list__item" id="-gy2rbs_262"><p id="-gy2rbs_267"><code class="code" id="-gy2rbs_268">dispatch.xml</code></p></li><li class="list__item" id="-gy2rbs_263"><p id="-gy2rbs_269"><code class="code" id="-gy2rbs_270">queue.xml</code></p></li><li class="list__item" id="-gy2rbs_264"><p id="-gy2rbs_271"><code class="code" id="-gy2rbs_272">datastore-indexes.xml</code></p></li><li class="list__item" id="-gy2rbs_265"><p id="-gy2rbs_273"><code class="code" id="-gy2rbs_274">cron.xml</code></p></li><li class="list__item" id="-gy2rbs_266"><p id="-gy2rbs_275"><code class="code" id="-gy2rbs_276">dos.xml</code></p></li></ul><p id="-gy2rbs_261">If you use any of these files, put them in the default module's WEB-INF directory.</p></section><section class="chapter"><h3 id="an-example" data-toc="an-example">An example</h3><p id="-gy2rbs_277">Here is an example of how you would configure the various files in an EAR directory structure for an application that has two modules: a default module that handles web requests, plus another module (named <code class="code" id="-gy2rbs_288">my-module</code>) for backend processing.</p><p id="-gy2rbs_278">Assuming that the top-level EAR directory is &quot;my-application,&quot; define the file <code class="code" id="-gy2rbs_289">my-application/META-INF/appengine-application.xml</code>:</p><div class="code-block" data-lang="none">
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;no&quot;?&gt;
&lt;appengine-application xmlns=&quot;http://appengine.google.com/ns/1.0&quot;&gt;
  &lt;application&gt;my-application&lt;/application&gt;
&lt;/appengine-application&gt;
</div><p id="-gy2rbs_280">Create WAR directories for the two modules: <code class="code" id="-gy2rbs_290">my-application/default</code> and <code class="code" id="-gy2rbs_291">my-application/my-module</code>.</p><p id="-gy2rbs_281">Now create an <code class="code" id="-gy2rbs_292">appengine-web.xml</code> file in each WAR that specifies the parameters for the module. The file must include a version name for the module. To define the default module, you can explicitly include the <code class="code" id="-gy2rbs_293">&lt;module&gt;default&lt;/module&gt;</code> parameter or leave it out of the file. Here is the file <code class="code" id="-gy2rbs_294">my-application/default/WEB-INF/appengine-web.xml</code> that defines the default module:</p><div class="code-block" data-lang="none">
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;no&quot;?&gt;
&lt;appengine-web-app xmlns=&quot;http://appengine.google.com/ns/1.0&quot;&gt;
  &lt;application&gt;my-application&lt;/application&gt;
  &lt;module&gt;default&lt;/module&gt;
  &lt;version&gt;uno&lt;/version&gt;
  &lt;threadsafe&gt;true&lt;/threadsafe&gt;
&lt;/appengine-web-app&gt;
</div><p id="-gy2rbs_283">The file <code class="code" id="-gy2rbs_295">my-application/my-module/WEB-INF/appengine-web.xml</code> defines the module that will handle background requests:</p><div class="code-block" data-lang="none">
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;no&quot;?&gt;
&lt;appengine-web-app xmlns=&quot;http://appengine.google.com/ns/1.0&quot;&gt;
  &lt;application&gt;my-application&lt;/application&gt;
  &lt;module&gt;my-module&lt;/module&gt;
  &lt;version&gt;uno&lt;/version&gt;
  &lt;threadsafe&gt;true&lt;/threadsafe&gt;
  &lt;manual-scaling&gt;
    &lt;instances&gt;5&lt;/instances&gt;
  &lt;/manual-scaling&gt;
&lt;/appengine-web-app&gt;
</div><p id="-gy2rbs_285">Finally, define the file <code class="code" id="-gy2rbs_296">my-application/META-INF/application.xml</code> that enumerates the modules. Note that the default module should be the first module listed.</p><div class="code-block" data-lang="none">
&lt;?xml version=&quot;1.0&quot;
encoding=&quot;UTF-8&quot;?&gt;

&lt;application
  xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot;
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee
                      http://java.sun.com/xml/ns/javaee/application_5.xsd&quot;
  version=&quot;5&quot;&gt;

  &lt;description&gt;GAE Java SuperFun app&lt;/description&gt;
  &lt;display-name&gt;SuperFun&lt;/display-name&gt;

  &lt;!-- Modules --&gt;
  &lt;!-- The default module should be listed first --&gt;
  &lt;module&gt;
    &lt;web&gt;
      &lt;web-uri&gt;default&lt;/web-uri&gt;
      &lt;context-root&gt;default&lt;/context-root&gt;
    &lt;/web&gt;
  &lt;/module&gt;
  &lt;module&gt;
    &lt;web&gt;
      &lt;web-uri&gt;my-module&lt;/web-uri&gt;
      &lt;context-root&gt;my-module&lt;/context-root&gt;
    &lt;/web&gt;
  &lt;/module&gt;

&lt;/application&gt;
</div><p id="-gy2rbs_287">App Engine will ignore the <code class="code" id="-gy2rbs_297">&lt;context-root&gt;</code> elements, so HTTP clients need not prepend it to the URL path when addressing a module.</p></section></section><section class="chapter"><h2 id="uploading-and-deleting-modules" data-toc="uploading-and-deleting-modules">Uploading and deleting modules</h2><p id="-gy2rbs_298">To deploy the example above, use the <a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/java/gettingstarted/uploading" id="-gy2rbs_307" data-external="true" rel="noopener noreferrer" target="_blank"><code class="code" id="-gy2rbs_308">appcfg update</code></a> command, passing the directory path of the EAR:</p><div class="code-block" data-lang="none">
appcfg.sh update &lt;directory-path&gt;
</div><p id="-gy2rbs_300">To only upload a specific module, give the directory path for its WAR:</p><div class="code-block" data-lang="none">
appcfg.sh update &lt;directory-path&gt;/my-application/my-module
</div><p id="-gy2rbs_302">If you are uploading the app for the first time, you must either pass the EAR path, or upload the WAR directory for the default module first.</p><p id="-gy2rbs_303">You will receive verification via the command line as each module is successfully deployed. Once the application has been deployed you can access it at <code class="code" id="-gy2rbs_309">http://my-application.appspot.com</code>.</p><p id="-gy2rbs_304">Similarly, you can access each of the modules individually:</p><ul class="list _bullet" id="-gy2rbs_305"><li class="list__item" id="-gy2rbs_310"><p id="-gy2rbs_312"><code class="code" id="-gy2rbs_313">http://default.my-application.appspot.com</code></p></li><li class="list__item" id="-gy2rbs_311"><p id="-gy2rbs_314"><code class="code" id="-gy2rbs_315">http://my-module.my-application.appspot.com</code></p></li></ul><p id="-gy2rbs_306">If you have uploaded multiple versions of the same module, you can access a specific version by prepending the version name to the URI. For example, <code class="code" id="-gy2rbs_316">http://uno.default.my-application.appspot.com</code> will target version uno of the default module. <a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/java/modules/routing" id="-gy2rbs_317" data-external="true" rel="noopener noreferrer" target="_blank">Routing Requests to Modules</a> explains addressing module instances in detail.</p></section><section class="chapter"><h2 id="instance-states" data-toc="instance-states">Instance states</h2><p id="-gy2rbs_318">A manual or basic scaled instance can be in one of two states: <code class="code" id="-gy2rbs_321">Running</code> or <code class="code" id="-gy2rbs_322">Stopped</code>. All instances of a particular module/version share the same state. You can change the state of all the instances belonging to a module/version using the <code class="code" id="-gy2rbs_323">appcfg</code> command or the Modules API.</p><section class="chapter"><h3 id="startup" data-toc="startup">Startup</h3><p id="-gy2rbs_324">Each module instance is created in response to a start request, which is an empty GET request to <code class="code" id="-gy2rbs_328">/_ah/start</code>. App Engine sends this request to bring an instance into existence; users cannot send a request to <code class="code" id="-gy2rbs_329">/_ah/start</code>. Manual and basic scaling instances must respond to the start request before they can handle another request. The start request can be used for two purposes:</p><ul class="list _bullet" id="-gy2rbs_325"><li class="list__item" id="-gy2rbs_330"><p id="-gy2rbs_332">To start a program that runs indefinitely, without accepting further requests</p></li><li class="list__item" id="-gy2rbs_331"><p id="-gy2rbs_333">To initialize an instance before it receives additional traffic</p></li></ul><p id="-gy2rbs_326">Manual, basic, and automatically scaling instances startup differently. When you start a manual scaling instance, App Engine immediately sends a <code class="code" id="-gy2rbs_334">/_ah/start</code> request to each instance. When you start an instance of a basic scaling module, App Engine allows it to accept traffic, but the <code class="code" id="-gy2rbs_335">/_ah/start</code> request is not sent to an instance until it receives its first user request. Multiple basic scaling instances are only started as necessary, in order to handle increased traffic. Automatically scaling instances do not receive any <code class="code" id="-gy2rbs_336">/_ah/start</code> request.</p><p id="-gy2rbs_327">When an instance responds to the <code class="code" id="-gy2rbs_337">/_ah/start</code> request with an HTTP status code of <code class="code" id="-gy2rbs_338">200&ndash;299</code> or <code class="code" id="-gy2rbs_339">404</code>, it is considered to have successfully started and can handle additional requests. Otherwise, App Engine terminates the instance. Manual scaling instances are restarted immediately, while basic scaling instances are restarted only when needed for serving traffic.</p></section><section class="chapter"><h3 id="shutdown" data-toc="shutdown">Shutdown</h3><p id="-gy2rbs_340">The shutdown process may be triggered by a variety of planned and unplanned events, such as:</p><ul class="list _bullet" id="-gy2rbs_341"><li class="list__item" id="-gy2rbs_349"><p id="-gy2rbs_356">You manually stop an instance using the <code class="code" id="-gy2rbs_357">appcfg stop</code> command or the Modules API <code class="code" id="-gy2rbs_358">stopVersion</code> function call.</p></li><li class="list__item" id="-gy2rbs_350"><p id="-gy2rbs_359">Manually stop an instance from the Cloud Platform Console Instances page.</p></li><li class="list__item" id="-gy2rbs_351"><p id="-gy2rbs_360">You update the module version using <code class="code" id="-gy2rbs_361">appcfg update</code>.</p></li><li class="list__item" id="-gy2rbs_352"><p id="-gy2rbs_362">The instance exceeds the maximum memory for its configured <code class="code" id="-gy2rbs_363">instance_class</code>.</p></li><li class="list__item" id="-gy2rbs_353"><p id="-gy2rbs_364">Your application runs out of Instance Hours quota.</p></li><li class="list__item" id="-gy2rbs_354"><p id="-gy2rbs_365">The machine running the instance is restarted, forcing your instance to move to a different machine.</p></li><li class="list__item" id="-gy2rbs_355"><p id="-gy2rbs_366">App Engine needs to move your instance to a different machine to improve load distribution.</p></li></ul><p id="-gy2rbs_342">There are two ways for an app to determine if a manual scaling instance is about to be shut down. First, the <a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/java/javadoc/com/google/appengine/api/LifecycleManager" id="-gy2rbs_367" data-external="true" rel="noopener noreferrer" target="_blank"><code class="code" id="-gy2rbs_371">isShuttingDown()</code></a> method begins returning <code class="code" id="-gy2rbs_368">true</code>. Second (and preferred), if you have <a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/java/javadoc/com/google/appengine/api/LifecycleManager.ShutdownHook" id="-gy2rbs_369" data-external="true" rel="noopener noreferrer" target="_blank">registered a shutdown hook</a>, it is called. When App Engine begins to shut down an instance, existing requests are given 30 seconds to complete, and new requests immediately return <code class="code" id="-gy2rbs_370">404</code>.</p><p id="-gy2rbs_343">As soon as App Engine starts to shut down an instance, all new requests immediately return <code class="code" id="-gy2rbs_372">404</code>. If the instance is idle and there is a shutdown hook, the hook runs immediately. If the instance is handling a request, it is given 30 seconds to finish before the shutdown hook is called. If the handler does not complete, it will be interrupted and the hook will run.</p><p id="-gy2rbs_344">When App Engine starts to shut down an instance, it sends an <code class="code" id="-gy2rbs_373">/_ah/stop</code> request that appears in the log but is ignored by the request handling logic and cannot be handled by user code.</p><p id="-gy2rbs_345">The following code sample demonstrates a basic shutdown hook:</p><div class="code-block" data-lang="none">
LifecycleManager.getInstance().setShutdownHook(new ShutdownHook() {
  public void shutdown() {
    LifecycleManager.getInstance().interruptAllRequests();
  }
});
</div><p id="-gy2rbs_347">Alternatively, the following sample demonstrates how to use the isShuttingDown() method:</p><div class="code-block" data-lang="none">
while (haveMoreWork()
&amp;&amp; !LifecycleManager.getInstance().isShuttingDown()) {
  doSomeWork();
  saveState();
}
</div></section></section><section class="chapter"><h2 id="instance-uptime" data-toc="instance-uptime">Instance uptime</h2><p id="-gy2rbs_374">App Engine attempts to keep manual and basic scaling instances running indefinitely. However, at this time there is no guaranteed uptime for manual and basic scaling instances. Hardware and software failures that cause early termination or frequent restarts can occur without prior warning and may take considerable time to resolve; thus, you should construct your application in a way that tolerates these failures. The App Engine team will provide more guidance on expected instance uptime as statistics become available.</p><p id="-gy2rbs_375">Here are some good strategies for avoiding downtime due to instance restarts:</p><ul class="list _bullet" id="-gy2rbs_376"><li class="list__item" id="-gy2rbs_378"><p id="-gy2rbs_384">Use load balancing across multiple instances.</p></li><li class="list__item" id="-gy2rbs_379"><p id="-gy2rbs_385">Configure more instances than are normally required to handle your traffic patterns.</p></li><li class="list__item" id="-gy2rbs_380"><p id="-gy2rbs_386">Write fall-back logic that uses cached results when a manual scaling instance is unavailable.</p></li><li class="list__item" id="-gy2rbs_381"><p id="-gy2rbs_387">Reduce the amount of time it takes for your instances to start up and shutdown.</p></li><li class="list__item" id="-gy2rbs_382"><p id="-gy2rbs_388">Duplicate the state information across more than one instance.</p></li><li class="list__item" id="-gy2rbs_383"><p id="-gy2rbs_389">For long-running computations, checkpoint the state from time to time so you can resume it if it doesn't complete.</p></li></ul><p id="-gy2rbs_377">It's also important to recognize that the shutdown hook is not always able to run before an instance terminates. In rare cases, an outage can occur that prevents App Engine from providing 30 seconds of shutdown time. Thus, we recommend periodically checkpointing the state of your instance and using it primarily as an in-memory cache rather than a reliable data store.</p></section><section class="chapter"><h2 id="background-threads" data-toc="background-threads">Background threads</h2><p id="-gy2rbs_390">Code running on a manual scaling instance can start a background thread that may outlive the request that spawns it. This allows instances to perform arbitrary periodic or scheduled tasks or to continue working in the background after a request has returned to the user.</p><p id="-gy2rbs_391">A background thread's logging entries are independent of those of the spawning thread. You can read more about background threads in App Engine's <a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/java/javadoc/com/google/appengine/api/ThreadManager" id="-gy2rbs_395" data-external="true" rel="noopener noreferrer" target="_blank"><code class="code" id="-gy2rbs_396">ThreadManager</code></a> documentation.</p><div class="code-block" data-lang="none">
import com.google.appengine.api.ThreadManager;
import java.util.concurrent.atomic.AtomicLong;

AtomicLong counter = new AtomicLong();

Thread thread = ThreadManager.createBackgroundThread(new Runnable() {
  public void run() {
    try {
      while (true) {
        counter.incrementAndGet();
        Thread.sleep(10);
      }
    } catch (InterruptedException ex) {
      throw new RuntimeException(&quot;Interrupted in loop:&quot;, ex);
    }
  }
});
thread.start();
</div><p id="-gy2rbs_393">If code running in an automatic scaling module attempts to start a background thread, it raises an exception.</p><p id="-gy2rbs_394">The maximum number of concurrent background threads is 10 per instance.</p></section><section class="chapter"><h2 id="monitoring-resource-usage" data-toc="monitoring-resource-usage">Monitoring resource usage</h2><p id="-gy2rbs_397">The Instances page of the <a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/developers-console/#instances" id="-gy2rbs_399" data-external="true" rel="noopener noreferrer" target="_blank">Cloud Platform Console</a> provides visibility into how instances are performing. By selecting your module and version in the dropdowns, you can see the memory and CPU usage of each instance, uptime, number of requests, and other statistics. You can also manually initiate the shutdown process for any instance.</p><p id="-gy2rbs_398">You also can use the Runtime API to access statistics showing the CPU and memory usage of your instances. These statistics help you understand how resource usage responds to requests or work performed, and also how to regulate the amount of data stored in memory in order to stay below the memory limit of your instance class.</p></section><section class="chapter"><h2 id="logging" data-toc="logging">Logging</h2><p id="-gy2rbs_400">You can use the <a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/java/logs" id="-gy2rbs_402" data-external="true" rel="noopener noreferrer" target="_blank">Logs API</a> to access your app's request and application logs. In particular, the <code class="code" id="-gy2rbs_403">fetch()</code> function allows you to retrieve logs using various filters, such as request ID, timestamp, module ID, and version ID.</p><p id="-gy2rbs_401">Application (user/app-generated) logs are periodically flushed while manual and basic scaling instances handle requests; since modules can run on a request a long time, logs may not flush for a while. You can tune the flush settings, or force an immediate flush, using the Logs API. When a flush occurs, a new log entry is created at the time of the flush, containing any log messages that have not yet been flushed. These entries show up in the Cloud Platform Console <a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/developers-console/#logs" id="-gy2rbs_404" data-external="true" rel="noopener noreferrer" target="_blank">Logs page</a> marked with <span class="control" id="-gy2rbs_405">flush</span>, and include the start time of the request that generated the flush.</p></section><section class="chapter"><h2 id="communication-between-modules" data-toc="communication-between-modules">Communication between modules</h2><p id="-gy2rbs_406">Modules can share state by using the Datastore and Memcache. They can collaborate by assigning work between them using Task Queues. To access these shared services, use the corresponding App Engine APIs. Calls to these APIs are automatically mapped to the application&rsquo;s namespace.</p><p id="-gy2rbs_407">The Modules API provides functions to retrieve the address of a module, a version, or an instance. This allows an application to send requests from one module, version, or instance to another module, version, or instance. This works in both the development and production environments. The Modules API also provides functions that return information about the current operating environment (module, version, and instance).</p><p id="-gy2rbs_408">The following code sample shows how to get the module name and instance id for a request:</p><div class="code-block" data-lang="none">
import com.google.appengine.api.modules.ModulesService;
import com.google.appengine.api.modules.ModulesServiceFactory;

ModulesService modulesApi = ModulesServiceFactory.getModulesService();

// Get the module name handling the current request.
String currentModuleName = modulesApi.getCurrentModule();
// Get the instance handling the current request.
int currentInstance = modulesApi.getCurrentInstance();
</div><p id="-gy2rbs_410">The instance ID of an automatic scaled module will be returned as a unique base64 encoded value, e.g. <code class="code" id="-gy2rbs_417">e4b565394caa</code>.</p><p id="-gy2rbs_411">You can communicate between modules in the same app by fetching the hostname of the target module:</p><div class="code-block" data-lang="none">
import com.google.appengine.api.modules.ModulesService;
import com.google.appengine.api.modules.ModulesServiceFactory;

import java.net.MalformedURLException;
import java.net.URL;
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.io.IOException;

// ...

ModulesService modulesApi = ModulesServiceFactory.getModulesService();

// ...
    try {
        URL url = new URL(&quot;http://&quot; +
            modulesApi.getVersionHostname(&quot;my-backend-module&quot;,&quot;v1&quot;) +
            &quot;/fetch-stats&quot;);
        BufferedReader reader = new BufferedReader(
            new InputStreamReader(url.openStream()));
        String line;

        while ((line = reader.readLine()) != null) {
            // Do something...
        }
        reader.close();

    } catch (MalformedURLException e) {
        // ...
    } catch (IOException e) {
        // ...
    }
</div><p id="-gy2rbs_413">You can also use the <a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/java/urlfetch" id="-gy2rbs_418" data-external="true" rel="noopener noreferrer" target="_blank">URL Fetch</a> service.</p><p id="-gy2rbs_414">To be safe, the receiving module should validate that the request is coming from a valid client. You can check that the Inbound-AppId header or user-agent-string matches the app-id fetched with the <a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/java/appidentity" id="-gy2rbs_419" data-external="true" rel="noopener noreferrer" target="_blank">AppIdentity</a> service. Or you can use <a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/java/oauth" id="-gy2rbs_420" data-external="true" rel="noopener noreferrer" target="_blank">OAuth</a> to authenticate the request.</p><p id="-gy2rbs_415">You can configure any manual or basic scaling module to accept requests from other modules in your app by restricting its handler to only allow administrator accounts, using a <a href="https://web.archive.org/web/20160425095823/https://cloud.google.com/appengine/docs/java/config/webxml#Security_and_Authentication" id="-gy2rbs_421" data-external="true" rel="noopener noreferrer" target="_blank"><code class="code" id="-gy2rbs_424">&lt;security-constraint&gt;</code></a> with a <code class="code" id="-gy2rbs_422">&lt;role-name&gt;admin&lt;/role-name&gt;</code> in the module's <code class="code" id="-gy2rbs_423">web.xml</code> deployment descriptor. With this restriction in place, any URLFetch from any other module in the app will be automatically authenticated by App Engine, and any request that is not from the application will be rejected.</p><p id="-gy2rbs_416">If you want a module to receive requests from anywhere, you must code your own secure solution as you would for any App Engine application. This is usually done by implementing a custom API and authentication mechanism.</p></section><section class="chapter"><h2 id="limits" data-toc="limits">Limits</h2><p id="-gy2rbs_425">The maximum number of modules and versions that you can deploy depends on your app's pricing:</p><div class="table-wrapper"><table class="wide" id="-gy2rbs_426"><thead><tr class="ijRowHead" id="-gy2rbs_429"><th id="-gy2rbs_432"><p>Limit</p></th><th id="-gy2rbs_433"><p>Free App</p></th><th id="-gy2rbs_434"><p>Paid App</p></th></tr></thead><tbody><tr id="-gy2rbs_430"><td id="-gy2rbs_435"><p>Maximum Modules Per App</p></td><td id="-gy2rbs_436"><p>5</p></td><td id="-gy2rbs_437"><p>20</p></td></tr><tr id="-gy2rbs_431"><td id="-gy2rbs_438"><p>Maximum Versions Per App</p></td><td id="-gy2rbs_439"><p>15</p></td><td id="-gy2rbs_440"><p>60</p></td></tr></tbody></table></div><p id="-gy2rbs_427">There is also a limit to the number of instances for each module with basic or manual scaling:</p><div class="table-wrapper"><table class="" id="-gy2rbs_428"><thead><tr class="ijRowHead" id="-gy2rbs_441"><th id="-gy2rbs_444" colspan="3"><p>Maximum Instances per Manual/Basic Scaling Version</p></th></tr></thead><tbody><tr id="-gy2rbs_442"><td id="-gy2rbs_445"><p>Free App</p></td><td id="-gy2rbs_446"><p>Paid App US</p></td><td id="-gy2rbs_447"><p>Paid App EU</p></td></tr><tr id="-gy2rbs_443"><td id="-gy2rbs_448"><p>20</p></td><td id="-gy2rbs_449"><p>200</p></td><td id="-gy2rbs_450"><p>25</p></td></tr></tbody></table></div></section><div class="last-modified">10 April 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="concepts.html" class="navigation-links__prev">Concepts</a><a href="java-runtime-environment.html" class="navigation-links__next">Java Runtime Environment</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>