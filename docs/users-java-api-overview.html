<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-07-13T01:56:44.030664248"><title>Users Java API Overview | Google App Engine Java Documentation</title><script type="application/json" id="virtual-toc-data">[{"id":"user-authentication-in-java","level":0,"title":"User authentication in Java","anchor":"#user-authentication-in-java"},{"id":"authentication-options","level":0,"title":"Authentication options","anchor":"#authentication-options"},{"id":"signing-in-and-out","level":0,"title":"Signing in and out","anchor":"#signing-in-and-out"},{"id":"accessing-account-information","level":0,"title":"Accessing account information","anchor":"#accessing-account-information"},{"id":"users-and-the-datastore","level":0,"title":"Users and the Datastore","anchor":"#users-and-the-datastore"},{"id":"google-accounts-and-the-development-server","level":0,"title":"Google accounts and the development server","anchor":"#google-accounts-and-the-development-server"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Users Java API Overview | Google App Engine Java Documentation"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Google App Engine Java Documentation Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/users-java-api-overview.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Users Java API Overview | Google App Engine Java Documentation"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/users-java-api-overview.html#webpage",
    "url": "writerside-documentation/users-java-api-overview.html",
    "name": "Users Java API Overview | Google App Engine Java Documentation",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Google App Engine Java Documentation Help"
}</script><!-- End Schema.org --></head><body data-id="Users-Java-API-Overview" data-main-title="Users Java API Overview" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Guides.md|Guides///Authenticating-Users.md|Authenticating Users"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Google App Engine Java Documentation  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Users-Java-API-Overview" id="Users-Java-API-Overview.md">Users Java API Overview</h1><p id="uh7x57_3"><a href="https://web.archive.org/web/20160425095409/https://cloud.google.com/appengine/docs/python/users/" id="uh7x57_16" data-tooltip="View this page in the Python runtime" data-external="true" rel="noopener noreferrer" target="_blank">Python</a> |Java |<a href="https://web.archive.org/web/20160425095409/https://cloud.google.com/appengine/docs/php/users/" id="uh7x57_17" data-tooltip="View this page in the PHP runtime" data-external="true" rel="noopener noreferrer" target="_blank">PHP</a> |<a href="https://web.archive.org/web/20160425095409/https://cloud.google.com/appengine/docs/go/users/" id="uh7x57_18" data-tooltip="View this page in the Go runtime" data-external="true" rel="noopener noreferrer" target="_blank">Go</a></p><p id="uh7x57_4"><a href="https://web.archive.org/web/20160425095409/http://stackoverflow.com/questions/tagged/google-app-engine+user" id="uh7x57_19" data-external="true" rel="noopener noreferrer" target="_blank"><figure id="uh7x57_20"><img alt="Stack overflow questions" src="https://web.archive.org/web/20160425095409im_/https://cloud.google.com/cloud/images/stack_overflow_questions.png" title="Stack Overflow Questions" width="240" height="53"></figure></a></p><p id="uh7x57_5"><a href="https://web.archive.org/web/20160425095409/http://stackoverflow.com/feeds/tag?sort=votes&amp;tagnames=google-app-engine%2Buser" id="uh7x57_21" data-external="true" rel="noopener noreferrer" target="_blank">https://web.archive.org/web/20160425095409/http://stackoverflow.com/feeds/tag?sort=votes&amp;tagnames=google-app-engine%2Buser</a></p><p id="uh7x57_6"></p><p id="uh7x57_7"><a href="https://web.archive.org/web/20160425095409/http://stackoverflow.com/questions/tagged/google-app-engine+user?sort=votes" id="uh7x57_22" data-external="true" rel="noopener noreferrer" target="_blank">See more...</a></p><p id="uh7x57_8">App Engine applications can authenticate users using one of these methods: Google Accounts or accounts on your own Google Apps domains. An application can detect whether the current user has signed in, and can redirect the user to the appropriate sign-in page to sign in or, if your app uses Google Accounts authentication, create a new account. While a user is signed in to the application, the app can access the user's email address . The app can also detect whether the current user is an administrator, making it easy to implement admin-only areas of the app.</p><ol class="list _decimal" id="uh7x57_9" type="1"><li class="list__item" id="uh7x57_23"><p id="uh7x57_29"><span id="uh7x57_30">User authentication in Java</span></p></li><li class="list__item" id="uh7x57_24"><p id="uh7x57_31"><span id="uh7x57_32">Authentication options</span></p></li><li class="list__item" id="uh7x57_25"><p id="uh7x57_33"><span id="uh7x57_34">Signing in and out</span></p></li><li class="list__item" id="uh7x57_26"><p id="uh7x57_35"><span id="uh7x57_36">Accessing account information</span></p></li><li class="list__item" id="uh7x57_27"><p id="uh7x57_37"><span id="uh7x57_38">Users and the Datastore</span></p></li><li class="list__item" id="uh7x57_28"><p id="uh7x57_39"><span id="uh7x57_40">Google accounts and the development server</span></p></li></ol><section class="chapter"><h2 id="user-authentication-in-java" data-toc="user-authentication-in-java">User authentication in Java</h2><p id="uh7x57_41">The following example greets a user who has signed in to the app with a personalized message and a link to sign out. If the user is not signed in, the app offers a link to the sign-in page for Google Accounts.</p><p id="uh7x57_42">You can test if the user is signed in and get the user's email address using the standard servlet API, with the request object's <code class="code" id="uh7x57_46">getUserPrincipal()</code> method. You can use the User service API to generate sign-in and sign-out URLs.</p><div class="code-block" data-lang="none">
import java.io.IOException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import com.google.appengine.api.users.UserService;
import com.google.appengine.api.users.UserServiceFactory;

public class MyServlet extends HttpServlet {
    @Override
    public void doGet(HttpServletRequest req, HttpServletResponse resp)
            throws IOException {
        UserService userService = UserServiceFactory.getUserService();

        String thisURL = req.getRequestURI();

        resp.setContentType(&quot;text/html&quot;);
        if (req.getUserPrincipal() != null) {
            resp.getWriter().println(&quot;&lt;p&gt;Hello, &quot; +
                                     req.getUserPrincipal().getName() +
                                     &quot;!  You can &lt;a href=\&quot;&quot; +
                                     userService.createLogoutURL(thisURL) +
                                     &quot;\&quot;&gt;sign out&lt;/a&gt;.&lt;/p&gt;&quot;);
        } else {
            resp.getWriter().println(&quot;&lt;p&gt;Please &lt;a href=\&quot;&quot; +
                                     userService.createLoginURL(thisURL) +
                                     &quot;\&quot;&gt;sign in&lt;/a&gt;.&lt;/p&gt;&quot;);
        }
    }
}
</div><p id="uh7x57_44">The User service API can return the current user's information as a User object. Although User objects can be stored as a property value in the datastore, we strongly recommend that you avoid doing so because this includes the email address along with the user's unique ID. If a user changes their email address and you compare their old, stored <code class="code" id="uh7x57_47">User</code> to the new <code class="code" id="uh7x57_48">User</code> value, they won't match. Instead, consider using the <code class="code" id="uh7x57_49">User</code> <span class="emphasis" id="uh7x57_50">user ID value</span> as the user's stable unique identifier.</p><section class="chapter"><h3 id="enforcing-sign-in-and-admin-access-with-web-xml" data-toc="enforcing-sign-in-and-admin-access-with-web-xml">Enforcing sign in and admin access with web.xml</h3><p id="uh7x57_51">If you have pages that the user should not be able to access unless signed in, you can establish a security constraint for those pages in the deployment descriptor (the <a href="https://web.archive.org/web/20160425095409/https://cloud.google.com/appengine/docs/java/config/webxml" id="uh7x57_54" data-external="true" rel="noopener noreferrer" target="_blank"><code class="code" id="uh7x57_55">web.xml</code></a> file). If a user accesses a URL with a security constraint and the user is not signed in, App Engine redirects the user to the sign-in page automatically (for Google Accounts or Google Apps authentication), then directs the user back to the URL after signing in or registering successfully.</p><p id="uh7x57_52">A security constraint can also require that the user be a registered administrator for the application. This makes it easy to build administrator-only sections of the site, without having to implement a separate authorization mechanism.</p><p id="uh7x57_53">To learn how to set security constraints for URLs, see <a href="https://web.archive.org/web/20160425095409/https://cloud.google.com/appengine/docs/java/config/webxml#Security_and_Authentication" id="uh7x57_56" data-external="true" rel="noopener noreferrer" target="_blank">The Deployment Descriptor: Security and Authentication</a> for <code class="code" id="uh7x57_57">web.xml</code>.</p></section></section><section class="chapter"><h2 id="authentication-options" data-toc="authentication-options">Authentication options</h2><p id="uh7x57_58">Your app can authenticate users using one of these options:</p><ul class="list _bullet" id="uh7x57_59"><li class="list__item" id="uh7x57_61"><p id="uh7x57_63">A Google Account</p></li><li class="list__item" id="uh7x57_62"><p id="uh7x57_64">An account on your Google Apps domain</p></li></ul><section class="chapter"><h3 id="choosing-an-authentication-option" data-toc="choosing-an-authentication-option">Choosing an authentication option</h3><p id="uh7x57_65">After you create your app, you can choose the authentication option you want to use. By default, your app will use Google Accounts for authentication. To choose another option, such as Google Apps domain, go to the <a href="https://web.archive.org/web/20160425095409/https://console.cloud.google.com//project/_/appengine/settings" id="uh7x57_66" data-external="true" rel="noopener noreferrer" target="_blank">settings</a> page for your project in the Google Cloud Platform Console and click <span class="control" id="uh7x57_67">Edit</span>. In the <span class="emphasis" id="uh7x57_68">Google authentication</span> dropdown menu, select the desired authentication type, and then click <span class="control" id="uh7x57_69">Save</span>.</p></section></section><section class="chapter"><h2 id="signing-in-and-out" data-toc="signing-in-and-out">Signing in and out</h2><p id="uh7x57_70">An application can detect whether a user has signed in to the app with your app's chosen authentication option. If the user is not signed in, the app can direct the user to Google Accounts to sign in or create a new Google account. The app gets the URL for the sign-in page by calling a method of the Users API. The app can display this URL as a link, or it can issue an HTTP redirect to the URL when the user visits a page that requires authentication.</p><p id="uh7x57_71">If your app uses Google Accounts or Google Apps for authentication, the name of your application appears on the sign-in page when the user signs in to your application, using the application name you chose when registering the application. You can change your application name in the Google Cloud Platform Console <a href="https://web.archive.org/web/20160425095409/https://console.cloud.google.com//project" id="uh7x57_75" data-external="true" rel="noopener noreferrer" target="_blank">projects page</a>. Click on the pencil icon for the project you want to rename.</p><p id="uh7x57_72">Once the user has signed in or created a Google account, the user is redirected back to your application. The app provides the redirect URL to the method that generates the sign-in URL.</p><p id="uh7x57_73">The Users API includes a method to generate a URL for signing out of the app. The sign-out URL de-authenticates the user from the app, then redirects back to the app's URL without displaying anything.</p><p id="uh7x57_74">A user is not signed in to an application until she is prompted to do so by the app and enters her account's email address and password. This is true even if the user has signed in to other applications using her Google Account.</p></section><section class="chapter"><h2 id="accessing-account-information" data-toc="accessing-account-information">Accessing account information</h2><p id="uh7x57_76">While a user is signed in to an app, the app can access the account's email address for every request the user makes to the app. The app can also access a user ID that identifies the user uniquely, even if the user changes the email address for her account.</p><p id="uh7x57_77">The app can also determine whether the current user is an administrator (a &quot;developer&quot;) for the app. You can use this feature to build administrative features for the app, even if you don't authenticate other users. The Go, Java, PHP and Python APIs make it easy to configure URLs as &quot;administrator only&quot;.</p><p id="uh7x57_78"><span class="control" id="uh7x57_79">Note:</span> Every user has the same user ID for all App Engine applications. If your app uses the user ID in public data, such as by including it in a URL parameter, you should use a hash algorithm with a &quot;salt&quot; value added to obscure the ID. Exposing raw IDs could allow someone to associate a user's activity in one app with that in another, or get the user's email address by coercing the user to sign in to another app.</p></section><section class="chapter"><h2 id="users-and-the-datastore" data-toc="users-and-the-datastore">Users and the Datastore</h2><p id="uh7x57_80">The User service API can return the current user's information as a User object. Although User objects can be stored as a property value in the datastore, we strongly recommend that you avoid doing so because this includes the email address along with the user's unique ID. If a user changes their email address and you compare their old, stored <code class="code" id="uh7x57_81">User</code> to the new <code class="code" id="uh7x57_82">User</code> value, they won't match. Instead, consider using the <code class="code" id="uh7x57_83">User</code> <span class="emphasis" id="uh7x57_84">user ID value</span> as the user's stable unique identifier.</p></section><section class="chapter"><h2 id="google-accounts-and-the-development-server" data-toc="google-accounts-and-the-development-server">Google accounts and the development server</h2><p id="uh7x57_85">The development server simulates the Google Accounts system using a dummy sign-in screen. When your application calls the Users API to get the URL for the sign-in screen, the API returns a special development server URL that prompts for an email address, but no password. You can type any email address into this prompt, and the app will behave as if you are signed in with an account with that address.</p><p id="uh7x57_86">The dummy sign-in screen also includes a checkbox that indicates whether the dummy account is an administrator. If you check this box, the app will behave as if you are signed in using an administrator account.</p><p id="uh7x57_87">Similarly, the Users API returns a sign-out URL that cancels the dummy sign-in.</p></section><div class="last-modified">10 April 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="oauth-api-for-java.html" class="navigation-links__prev">OAuth API for Java</a><a href="caching-application-data.html" class="navigation-links__next">Caching Application Data</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>