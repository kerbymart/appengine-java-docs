<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-07-13T01:56:44.564736406"><title>Channel Java API Overview | Google App Engine Java Documentation</title><script type="application/json" id="virtual-toc-data">[{"id":"overview","level":0,"title":"Overview","anchor":"#overview"},{"id":"elements-of-the-channel-api","level":0,"title":"Elements of the Channel API","anchor":"#elements-of-the-channel-api"},{"id":"life-of-a-typical-channel-message","level":0,"title":"Life of a typical channel message","anchor":"#life-of-a-typical-channel-message"},{"id":"sending-messages-to-different-app-versions","level":0,"title":"Sending messages to different app versions","anchor":"#sending-messages-to-different-app-versions"},{"id":"example-tic-tac-toe-application","level":0,"title":"Example Tic Tac Toe application","anchor":"#example-tic-tac-toe-application"},{"id":"tracking-client-connections-and-disconnections","level":0,"title":"Tracking client connections and disconnections","anchor":"#tracking-client-connections-and-disconnections"},{"id":"tokens-and-security","level":0,"title":"Tokens and security","anchor":"#tokens-and-security"},{"id":"caveats","level":0,"title":"Caveats","anchor":"#caveats"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Channel Java API Overview | Google App Engine Java Documentation"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Google App Engine Java Documentation Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/channel-java-api-overview.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Channel Java API Overview | Google App Engine Java Documentation"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/channel-java-api-overview.html#webpage",
    "url": "writerside-documentation/channel-java-api-overview.html",
    "name": "Channel Java API Overview | Google App Engine Java Documentation",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Google App Engine Java Documentation Help"
}</script><!-- End Schema.org --></head><body data-id="Channel-Java-API-Overview" data-main-title="Channel Java API Overview" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Guides.md|Guides///Connecting-to-and-from-Your-App.md|Connecting to and from Your App///Creating-a-Persistent-Connection-for-JavaScript-Clients.md|Creating a Persistent Connection for JavaScript Clients"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Google App Engine Java Documentation  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Channel-Java-API-Overview" id="Channel-Java-API-Overview.md">Channel Java API Overview</h1><p id="-ywjqmo_3"><a href="https://web.archive.org/web/20160425100002/https://cloud.google.com/appengine/docs/python/channel/" id="-ywjqmo_17" data-tooltip="View this page in the Python runtime" data-external="true" rel="noopener noreferrer" target="_blank">Python</a> |Java |PHP |<a href="https://web.archive.org/web/20160425100002/https://cloud.google.com/appengine/docs/go/channel/" id="-ywjqmo_18" data-tooltip="View this page in the Go runtime" data-external="true" rel="noopener noreferrer" target="_blank">Go</a></p><p id="-ywjqmo_4"><a href="https://web.archive.org/web/20160425100002/http://stackoverflow.com/questions/tagged/google-app-engine+channel" id="-ywjqmo_19" data-external="true" rel="noopener noreferrer" target="_blank"><figure id="-ywjqmo_20"><img alt="Stack overflow questions" src="https://web.archive.org/web/20160425100002im_/https://cloud.google.com/cloud/images/stack_overflow_questions.png" title="Stack Overflow Questions" width="240" height="53"></figure></a></p><p id="-ywjqmo_5"><a href="https://web.archive.org/web/20160425100002/http://stackoverflow.com/feeds/tag?sort=votes&amp;tagnames=google-app-engine%2Bchannel" id="-ywjqmo_21" data-external="true" rel="noopener noreferrer" target="_blank">https://web.archive.org/web/20160425100002/http://stackoverflow.com/feeds/tag?sort=votes&amp;tagnames=google-app-engine%2Bchannel</a></p><p id="-ywjqmo_6"></p><p id="-ywjqmo_7"><a href="https://web.archive.org/web/20160425100002/http://stackoverflow.com/questions/tagged/google-app-engine+channel?sort=votes" id="-ywjqmo_22" data-external="true" rel="noopener noreferrer" target="_blank">See more...</a></p><ol class="list _decimal" id="-ywjqmo_8" type="1"><li class="list__item" id="-ywjqmo_23"><p id="-ywjqmo_31"><span id="-ywjqmo_32">Overview</span></p></li><li class="list__item" id="-ywjqmo_24"><p id="-ywjqmo_33"><span id="-ywjqmo_34">Elements of the Channel API</span></p></li><li class="list__item" id="-ywjqmo_25"><p id="-ywjqmo_35"><span id="-ywjqmo_36">Life of a typical channel message</span></p></li><li class="list__item" id="-ywjqmo_26"><p id="-ywjqmo_37"><span id="-ywjqmo_38">Sending messages to different app versions</span></p></li><li class="list__item" id="-ywjqmo_27"><p id="-ywjqmo_39"><span id="-ywjqmo_40">Example Tic Tac Toe application</span></p></li><li class="list__item" id="-ywjqmo_28"><p id="-ywjqmo_41"><span id="-ywjqmo_42">Tracking client connections and disconnections</span></p></li><li class="list__item" id="-ywjqmo_29"><p id="-ywjqmo_43"><span id="-ywjqmo_44">Tokens and security</span></p></li><li class="list__item" id="-ywjqmo_30"><p id="-ywjqmo_45"><span id="-ywjqmo_46">Caveats</span></p></li></ol><section class="chapter"><h2 id="overview" data-toc="overview">Overview</h2><p id="-ywjqmo_47">The Channel API creates a persistent connection between your application and Google servers, allowing your application to send messages to JavaScript clients in real time without the use of polling. This is useful for applications designed to update users about new information immediately. Some example use-cases include collaborative applications, multi-player games, or chat rooms. In general, using the Channel API is a better choice than polling in situations where updates can't be predicted or scripted, such as when relaying information between human users or from events not generated systematically.</p></section><section class="chapter"><h2 id="elements-of-the-channel-api" data-toc="elements-of-the-channel-api">Elements of the Channel API</h2><section class="chapter"><h3 id="javascript-client" data-toc="javascript-client">Javascript client</h3><p id="-ywjqmo_56">The user interacts with a JavaScript client built into a webpage. The JavaScript client is primarily responsible for three things:</p><ul class="list _bullet" id="-ywjqmo_57"><li class="list__item" id="-ywjqmo_59"><p id="-ywjqmo_62">Connecting to the channel once it receives the channel&rsquo;s unique token from the server</p></li><li class="list__item" id="-ywjqmo_60"><p id="-ywjqmo_63">Listening on the channel for updates regarding other clients and making appropriate use of the data (e.g. updating the interface, etc.)</p></li><li class="list__item" id="-ywjqmo_61"><p id="-ywjqmo_64">Sending update messages to the server so they may be passed on to remote clients</p></li></ul><p id="-ywjqmo_58">Refer to the <a href="https://web.archive.org/web/20160425100002/https://cloud.google.com/appengine/docs/java/channel/javascript" id="-ywjqmo_65" data-external="true" rel="noopener noreferrer" target="_blank">JavaScript Reference</a> page for details on building your client.</p></section><section class="chapter"><h3 id="the-server" data-toc="the-server">The server</h3><p id="-ywjqmo_66">The server is responsible for:</p><ul class="list _bullet" id="-ywjqmo_67"><li class="list__item" id="-ywjqmo_68"><p id="-ywjqmo_73">Creating a unique channel for individual JavaScript clients</p></li><li class="list__item" id="-ywjqmo_69"><p id="-ywjqmo_74">Creating and sending a unique token to each JavaScript client so they may connect and listen to their channel</p></li><li class="list__item" id="-ywjqmo_70"><p id="-ywjqmo_75">Receiving update messages from clients via HTTP requests</p></li><li class="list__item" id="-ywjqmo_71"><p id="-ywjqmo_76">Sending update messages to clients via their channels</p></li><li class="list__item" id="-ywjqmo_72"><p id="-ywjqmo_77">Optionally, managing client connection state.</p></li></ul></section><section class="chapter"><h3 id="the-client-id" data-toc="the-client-id">The client ID</h3><p id="-ywjqmo_78">The Client ID is responsible for identifying individual JavaScript clients on the server. The server knows what channel on which to send a particular message because of the Client ID.</p><p id="-ywjqmo_79">A Client ID can be anything that makes sense in the design of your application. For example, you can use something like cookie or login information, randomized numerical ID, or a user-selected name.</p><p id="-ywjqmo_80">You may also create Client IDs in whatever way makes sense in your application. For example, you may choose to create the Client ID on the client and pass it to the server in an explicit request for a token, or create it on the server and inject it into the page&rsquo;s HTML when the server replies to the browser&rsquo;s request for the page.</p></section><section class="chapter"><h3 id="tokens" data-toc="tokens">Tokens</h3><p id="-ywjqmo_81">Tokens are responsible for allowing the JavaScript Client to connect and listen to the channel created for it. The server creates one token for each client using information such as the client&rsquo;s Client ID and expiration time.</p><p id="-ywjqmo_82">Tokens expire after two hours and should also be treated as secret. See the <span id="-ywjqmo_83">Tokens and Security</span> section for more details.</p></section><section class="chapter"><h3 id="the-channel" data-toc="the-channel">The channel</h3><p id="-ywjqmo_84">A channel is a one-way communication path through which the server sends updates to a specific JavaScript client identified by its Client ID. The server receives updates from clients via HTTP requests, then sends the messages to relevant clients via their channels.</p></section><section class="chapter"><h3 id="the-message" data-toc="the-message">The message</h3><p id="-ywjqmo_85">Messages are sent via HTTP requests from one client to the server. Once received, the server passes the message to the designated client via the correct channel identified by the Client ID. Messages are limited to 32K.</p><p id="-ywjqmo_86"><span class="control" id="-ywjqmo_87">Warning:</span> Avoid sending raw messages, especially when sending URLs. Instead, use <a href="https://web.archive.org/web/20160425100002/https://en.wikipedia.org/wiki/JSON" id="-ywjqmo_88" data-external="true" rel="noopener noreferrer" target="_blank">JSON</a> encoding to ensure that messages arrive intact.</p></section><section class="chapter"><h3 id="socket" data-toc="socket">Socket</h3><p id="-ywjqmo_89">The JavaScript client opens a socket using the token provided by the server. It uses the socket to listen for updates on the channel.</p></section><section class="chapter"><h3 id="presence" data-toc="presence">Presence</h3><p id="-ywjqmo_90">The server can register to receive a notification when a client connects to or disconnects from a channel.</p></section></section><section class="chapter"><h2 id="life-of-a-typical-channel-message" data-toc="life-of-a-typical-channel-message">Life of a typical channel message</h2><p id="-ywjqmo_91">These two diagrams illustrate the life of a typical example message sent via Channel API between two different clients using one possible implementation of Channel API.</p><figure id="-ywjqmo_92"><img alt="Channel overview01" src="https://web.archive.org/web/20160425100002im_/https://cloud.google.com/appengine/images/channel_overview01.png" title="Channel overview01"></figure><p id="-ywjqmo_93">This diagram shows the creation of a channel on the server. In this example, it shows the JavaScript client explicitly requests a token and sends its Client ID to the server. In contrast, you could choose to design your application to inject the token into the client before the page loads in the browser, or some other implementation if preferred.</p><p id="-ywjqmo_94">Next, the server uses Client A&rsquo;s Client ID to create a channel and then sends the token for that channel back to Client A. Client A uses the token to open a socket and listen for updates on the channel.</p><figure id="-ywjqmo_95"><img alt="Channel overview02" src="https://web.archive.org/web/20160425100002im_/https://cloud.google.com/appengine/images/channel_overview02.png" title="Channel overview02"></figure><p id="-ywjqmo_96">This diagram shows Client B sending a message using <code class="code" id="-ywjqmo_97">POST</code> to the server. The server processes the message and sends it to Client A over the channel. Client A receives the message and makes use of the new information.</p></section><section class="chapter"><h2 id="sending-messages-to-different-app-versions" data-toc="sending-messages-to-different-app-versions">Sending messages to different app versions</h2><p id="-ywjqmo_98">The <a href="https://web.archive.org/web/20160425100002/https://cloud.google.com/appengine/docs/java/javadoc/com/google/appengine/api/channel/package-summary" id="-ywjqmo_99" data-external="true" rel="noopener noreferrer" target="_blank"><code class="code" id="-ywjqmo_101">ChannelMessage</code></a> class can be initialized with a token passed as the <code class="code" id="-ywjqmo_100">clientId</code> parameter. This allows applications to send the message object from different versions of the app. For instance you could create the channel on the front end and then send messages from a backend of the app.</p></section><section class="chapter"><h2 id="example-tic-tac-toe-application" data-toc="example-tic-tac-toe-application">Example Tic Tac Toe application</h2><p id="-ywjqmo_102">To better illustrate how to use Channel API, take a look at the following example Tic Tac Toe game application written in Java. The game allows users to create a game, invite another player by sending out a URL, and play the game together in real time. The application updates both players' views of the board in real time as soon as the other player makes a move.</p><p id="-ywjqmo_103">The full source code of the application is available at the <a href="https://web.archive.org/web/20160425100002/http://code.google.com/p/java-channel-tic-tac-toe" id="-ywjqmo_108" data-external="true" rel="noopener noreferrer" target="_blank">Java Channel Tac Toe Project page</a>. We'll go over major highlights that illustrate Channel API below.</p><section class="chapter"><h3 id="creating-and-connecting-to-a-channel" data-toc="creating-and-connecting-to-a-channel">Creating and connecting to a channel</h3><p id="-ywjqmo_109">When a user visits the Tic Tac Toe game for the first time, two things happen:</p><ul class="list _bullet" id="-ywjqmo_110"><li class="list__item" id="-ywjqmo_116"><p id="-ywjqmo_118">The game servlet injects a token into the html page sent to the client. The client uses this token to open a socket and listen for updates on the channel.</p></li><li class="list__item" id="-ywjqmo_117"><p id="-ywjqmo_119">The game servlet provides the user with a URL they can share with a friend in order to invite him or her to join the game.</p></li></ul><p id="-ywjqmo_111">In order to initiate the process of creating a channel, Java applications call the <a href="https://web.archive.org/web/20160425100002/https://cloud.google.com/appengine/docs/java/javadoc/com/google/appengine/api/channel/ChannelServiceFactory#getChannelService()" id="-ywjqmo_120" data-external="true" rel="noopener noreferrer" target="_blank"><code class="code" id="-ywjqmo_124">ChannelServiceFactory.getChannelService()</code></a> method and get a <a href="https://web.archive.org/web/20160425100002/https://cloud.google.com/appengine/docs/java/javadoc/com/google/appengine/api/channel/ChannelService" id="-ywjqmo_121" data-external="true" rel="noopener noreferrer" target="_blank"><code class="code" id="-ywjqmo_125">ChannelService()</code></a> object. Then they use the object's <a href="https://web.archive.org/web/20160425100002/https://cloud.google.com/appengine/docs/java/javadoc/com/google/appengine/api/channel/ChannelService#createChannel(java.lang.String)" id="-ywjqmo_122" data-external="true" rel="noopener noreferrer" target="_blank"><code class="code" id="-ywjqmo_126">createChannel()</code></a> method and get a token that the client page can use to connect to the channel. When calling <code class="code" id="-ywjqmo_123">createChannel()</code>, they send a Client ID that uniquely identifies the client to the server.</p><div class="code-block" data-lang="none">
public class TicTacToeServlet extends HttpServlet {
  @Override
  public void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException {
    // Game creation, user sign-in, etc. omitted for brevity.
    String userId = userService.getCurrentUser().getUserId();

    ChannelService channelService = ChannelServiceFactory.getChannelService();

    // The 'Game' object exposes a method which creates a unique string based on the game's key
    // and the user's id.
    String token = channelService.createChannel(game.getChannelKey(userId));

    // Index is the contents of our index.html resource, details omitted for brevity.
    index = index.replaceAll(&quot;\\{\\{ token \\}\\}&quot;, token);

    resp.setContentType(&quot;text/html&quot;);
    resp.getWriter().write(index);
  }
}
</div><p id="-ywjqmo_113">The server returns the token to the client, which injects it into the index.html resource template and creates a new <code class="code" id="-ywjqmo_127">goog.appengine.Channel()</code> object.</p><div class="code-block" data-lang="none">
&lt;body&gt;
  &lt;script&gt;
    channel = new goog.appengine.Channel('{{ token }}');
    socket = channel.open();
    socket.onopen = onOpened;
    socket.onmessage = onMessage;
    socket.onerror = onError;
    socket.onclose = onClose;
  &lt;/script&gt;
&lt;/body&gt;
</div><p id="-ywjqmo_115">The game client uses the Channel object's <code class="code" id="-ywjqmo_128">open()</code> method to create a socket. The client also sets callback functions on the socket to be called when the state of the socket changes.</p></section><section class="chapter"><h3 id="opening-the-socket" data-toc="opening-the-socket">Opening the socket</h3><p id="-ywjqmo_129">In our example, when the Tic Tac Toe client is ready to receive messages, it calls the <code class="code" id="-ywjqmo_133">onOpened()</code> function, which it set to the socket's <a href="https://web.archive.org/web/20160425100002/https://cloud.google.com/appengine/docs/java/channel/javascript#onopen" id="-ywjqmo_134" data-external="true" rel="noopener noreferrer" target="_blank"><code class="code" id="-ywjqmo_137">onopen</code></a> callback. The <code class="code" id="-ywjqmo_135">onOpened</code> function also updates the UI for the user to indicate that the game is ready to play and sends a <code class="code" id="-ywjqmo_136">POST</code> message to the server to ask it to send the latest game state.</p><p id="-ywjqmo_130">The following client-side JavaScript code implements this functionality:</p><div class="code-block" data-lang="none">
sendMessage = function(path, opt_param) {
  path += '?g=' + state.game_key;
  if (opt_param) {
    path += '&amp;' + opt_param;
  }
  var xhr = new XMLHttpRequest();
  xhr.open('POST', path, true);
  xhr.send();
};

onOpened = function() {
  connected = true;
  sendMessage('opened');
  updateBoard();
};
</div><p id="-ywjqmo_132">Note that the application defines <code class="code" id="-ywjqmo_138">sendMessage()</code> as a wrapper around <code class="code" id="-ywjqmo_139">XmlHttpRequest</code>, which the client uses to send messages to the server.</p></section><section class="chapter"><h3 id="updating-the-game-state" data-toc="updating-the-game-state">Updating the game state</h3><p id="-ywjqmo_140">The Tic Tac Toe Javascript client uses an <code class="code" id="-ywjqmo_143">onClick</code> handler called <code class="code" id="-ywjqmo_144">moveInSquare</code> to handle mouse clicks in the board. When a player makes a move in our Tic Tac Toe game by clicking on a square, the client uses <code class="code" id="-ywjqmo_145">XmlHttpRequest</code> to send a <code class="code" id="-ywjqmo_146">POST</code> message to the application with the proposed move.</p><p id="-ywjqmo_141">The following client Javascript code snippet sends the message to the server:</p><div class="code-block" data-lang="none">
moveInSquare = function(id) {
  if (isMyMove() &amp;&amp; state.board[id] == ' ') {
    sendMessage('/move', 'i=' + id);
  }
}
</div></section><section class="chapter"><h3 id="validating-and-sending-the-new-game-state" data-toc="validating-and-sending-the-new-game-state">Validating and sending the new game state</h3><p id="-ywjqmo_147">Use an HTTP request to send messages from the client to the server. In our example, when the server receives the client's message via an HTTP request, it first uses its request handler to validate the move. Then, if the move is legal, the server uses the <a href="https://web.archive.org/web/20160425100002/https://cloud.google.com/appengine/docs/java/javadoc/com/google/appengine/api/channel/ChannelService#sendMessage(com.google.appengine.api.channel.ChannelMessage)" id="-ywjqmo_149" data-external="true" rel="noopener noreferrer" target="_blank"><code class="code" id="-ywjqmo_150">ChannelService.sendMessage()</code></a> method to send messages indicating the new state of the board to both clients.</p><div class="code-block" data-lang="none">
public class Game {
  // member variables, etc omitted for brevity.

  public String getChannelKey(String user) {
    return user + KeyFactory.keyToString(key);
  }

  private void sendUpdateToUser(String user) {
    if (user != null) {
      ChannelService channelService = ChannelServiceFactory.getChannelService();
      String channelKey = getChannelKey(user);
      channelService.sendMessage(new ChannelMessage(channelKey, getMessageString()));
    }
  }

  public void sendUpdateToClients() {
    sendUpdateToUser(userX);
    sendUpdateToUser(userO);
  }
}

public class MoveServlet extends HttpServlet {
  @Override
  public void doPost(HttpServletRequest req, HttpServletResponse resp) throws IOException {
    String gameId = req.getParameter(&quot;g&quot;);
    Game game = pm.getObjectById(Game.class, KeyFactory.stringToKey(gameId));

    // Code to retrieve user id, check rules and update game omitted for brevity
    game.sendUpdateToClients();
  }
}
</div></section></section><section class="chapter"><h2 id="tracking-client-connections-and-disconnections" data-toc="tracking-client-connections-and-disconnections">Tracking client connections and disconnections</h2><p id="-ywjqmo_151">Applications may register to be notified when a client connects to or disconnects from a channel.</p><p id="-ywjqmo_152">You can <a href="https://web.archive.org/web/20160425100002/https://cloud.google.com/appengine/docs/java/config/appconfig#Java_appengine_web_xml_Inbound_services" id="-ywjqmo_159" data-external="true" rel="noopener noreferrer" target="_blank">enable this inbound service</a> in <code class="code" id="-ywjqmo_160">appengine-web.xml</code>:</p><div class="code-block" data-lang="none">
&lt;inbound-services&gt;
  &lt;service&gt;channel_presence&lt;/service&gt;
&lt;/inbound-services&gt;
</div><p id="-ywjqmo_154">When you enable <code class="code" id="-ywjqmo_161">channel_presence</code>, your application receives POSTs to the following URL paths:</p><ul class="list _bullet" id="-ywjqmo_155"><li class="list__item" id="-ywjqmo_162"><p id="-ywjqmo_164">POSTs to <code class="code" id="-ywjqmo_165">/_ah/channel/connected/</code> signal that the client has connected to the channel and can receive messages.</p></li><li class="list__item" id="-ywjqmo_163"><p id="-ywjqmo_166">POSTs to <code class="code" id="-ywjqmo_167">/_ah/channel/disconnected/</code> signal that the client has disconnected from the channel.</p></li></ul><p id="-ywjqmo_156">Your application can register handlers to these paths in order to receive notifications. You can use these notifications to track which clients are currently connected.</p><p id="-ywjqmo_157">You can use the <code class="code" id="-ywjqmo_168">ChannelService</code> class's <code class="code" id="-ywjqmo_169">parsePresence()</code> to retrieve the <code class="code" id="-ywjqmo_170">client_id</code> of the connected or disconnected channel.</p><div class="code-block" data-lang="none">
// In the handler for _ah/channel/connected/
ChannelService channelService = ChannelServiceFactory.getChannelService();
ChannelPresence presence = channelService.parsePresence(req);
</div></section><section class="chapter"><h2 id="tokens-and-security" data-toc="tokens-and-security">Tokens and security</h2><p id="-ywjqmo_171">Treat the token returned by <code class="code" id="-ywjqmo_173">createChannel()</code> as a secret. If a malicious application gains access to the token, it could listen to messages sent along the channel you are using. Avoid using the token in a URL request because a malicious website could see it in their referrer logs.</p><p id="-ywjqmo_172">By default, tokens expire in two hours. If a client remains connected to a channel for longer than the token duration, the socket&rsquo;s <code class="code" id="-ywjqmo_174">onerror()</code> and <code class="code" id="-ywjqmo_175">onclose()</code> callbacks are called. At this point, the client can make an XHR request to the application to request a new token and open a new channel.</p></section><section class="chapter"><h2 id="caveats" data-toc="caveats">Caveats</h2><section class="chapter"><h3 id="one-client-per-client-id" data-toc="one-client-per-client-id">One client per client ID</h3><p id="-ywjqmo_178">Only one client at a time can connect to a channel using a given Client ID, so an application cannot use a Client ID for fan-out. In other words, it's not possible to create a central Client ID for connections to multiple clients (For example, you can't create a Client ID for something like a &quot;global-high-scores&quot; channel and use it to broadcast to multiple game clients.)</p></section><section class="chapter"><h3 id="one-client-per-channel-per-page" data-toc="one-client-per-channel-per-page">One client per channel per page</h3><p id="-ywjqmo_179">A client can only connect to one channel per page. If an application needs to send multiple types of data to a client, aggregate it on the server side and send it to appropriate handlers in the client&rsquo;s <a href="https://web.archive.org/web/20160425100002/https://cloud.google.com/appengine/docs/java/channel/javascript#onmessage" id="-ywjqmo_180" data-external="true" rel="noopener noreferrer" target="_blank"><code class="code" id="-ywjqmo_181">socket.onmessage</code></a> callback.</p></section></section><div class="last-modified">10 April 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="creating-a-persistent-connection-for-javascript-clients.html" class="navigation-links__prev">Creating a Persistent Connection for JavaScript Clients</a><a href="channel-api-javascript-reference-java.html" class="navigation-links__next">Channel API Javascript Reference (Java)</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>