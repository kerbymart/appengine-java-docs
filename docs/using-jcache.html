<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-07-13T01:56:44.139129837"><title>Using JCache | Google App Engine Java Documentation</title><script type="application/json" id="virtual-toc-data">[{"id":"getting-a-cache-instance","level":0,"title":"Getting a Cache Instance","anchor":"#getting-a-cache-instance"},{"id":"putting-and-getting-values","level":0,"title":"Putting and Getting Values","anchor":"#putting-and-getting-values"},{"id":"configuring-expiration","level":0,"title":"Configuring Expiration","anchor":"#configuring-expiration"},{"id":"configuring-the-set-policy","level":0,"title":"Configuring the Set Policy","anchor":"#configuring-the-set-policy"},{"id":"cache-statistics","level":0,"title":"Cache Statistics","anchor":"#cache-statistics"},{"id":"jcache-features-not-supported","level":0,"title":"JCache Features Not Supported","anchor":"#jcache-features-not-supported"},{"id":"features-of-the-low-level-api","level":0,"title":"Features of the Low-level API","anchor":"#features-of-the-low-level-api"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Using JCache | Google App Engine Java Documentation"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Google App Engine Java Documentation Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/using-jcache.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Using JCache | Google App Engine Java Documentation"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/using-jcache.html#webpage",
    "url": "writerside-documentation/using-jcache.html",
    "name": "Using JCache | Google App Engine Java Documentation",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Google App Engine Java Documentation Help"
}</script><!-- End Schema.org --></head><body data-id="Using-JCache" data-main-title="Using JCache" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Guides.md|Guides///Caching-Application-Data.md|Caching Application Data"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Google App Engine Java Documentation  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Using-JCache" id="Using-JCache.md">Using JCache</h1><p id="-4gixg4_3">The App Engine Java SDK supports the JCache interface (<a href="https://web.archive.org/web/20160424230647/http://jcp.org/en/jsr/detail?id=107" id="-4gixg4_14" data-external="true" rel="noopener noreferrer" target="_blank">JSR 107</a>) for accessing memcache. The interface is included in the <code class="code" id="-4gixg4_15">javax.cache</code> package.</p><p id="-4gixg4_4">With JCache, you can set and get values, control how values expire from the cache, inspect the contents of the cache, and get statistics about the cache. You can also use &quot;listeners&quot; to add custom behavior when setting and deleting values.</p><p id="-4gixg4_5">The JCache API standard is still in development. The App Engine implementation tries to implement a loyal subset. (For more information about JCache, see <a href="https://web.archive.org/web/20160424230647/http://jcp.org/en/jsr/detail?id=107" id="-4gixg4_16" data-external="true" rel="noopener noreferrer" target="_blank">JSR 107</a>.) However, instead of using JCache, you may want to consider using the <a href="https://web.archive.org/web/20160424230647/https://cloud.google.com/appengine/docs/java/javadoc/com/google/appengine/api/memcache/package-summary" id="-4gixg4_17" data-external="true" rel="noopener noreferrer" target="_blank">low-level Memcache API</a> to access more features of the underlying service.</p><ol class="list _decimal" id="-4gixg4_6" type="1"><li class="list__item" id="-4gixg4_18"><p id="-4gixg4_24"><span id="-4gixg4_25">Putting and Getting Values</span></p></li><li class="list__item" id="-4gixg4_19"><p id="-4gixg4_26"><span id="-4gixg4_27">Configuring Expiration</span></p></li><li class="list__item" id="-4gixg4_20"><p id="-4gixg4_28"><span id="-4gixg4_29">Configuring the Set Policy</span></p></li><li class="list__item" id="-4gixg4_21"><p id="-4gixg4_30"><span id="-4gixg4_31">Cache Statistics</span></p></li><li class="list__item" id="-4gixg4_22"><p id="-4gixg4_32"><span id="-4gixg4_33">JCache Features Not Supported</span></p></li><li class="list__item" id="-4gixg4_23"><p id="-4gixg4_34"><span id="-4gixg4_35">Features of the Low-level API</span></p></li></ol><section class="chapter"><h2 id="getting-a-cache-instance" data-toc="getting-a-cache-instance">Getting a Cache Instance</h2><p id="-4gixg4_36">You use an implementation of the <code class="code" id="-4gixg4_39">javax.cache.Cache</code> interface to interact with the cache. You obtain a Cache instance using a CacheFactory, which you obtain from a static method on the CacheManager. The following code gets a Cache instance with the default configuration:</p><div class="code-block" data-lang="none">
import java.util.Collections;
import javax.cache.Cache;
import javax.cache.CacheException;
import javax.cache.CacheFactory;
import javax.cache.CacheManager;

// ...
        Cache cache;
        try {
            CacheFactory cacheFactory = CacheManager.getInstance().getCacheFactory();
            cache = cacheFactory.createCache(Collections.emptyMap());
        } catch (CacheException e) {
            // ...
        }
</div><p id="-4gixg4_38">The CacheFactory's <code class="code" id="-4gixg4_40">createCache()</code> method takes a Map of configuration properties. These properties are discussed below. To accept the defaults, give the method an empty Map.</p></section><section class="chapter"><h2 id="putting-and-getting-values" data-toc="putting-and-getting-values">Putting and Getting Values</h2><p id="-4gixg4_41">The Cache behaves like a Map: You store keys and values using the <code class="code" id="-4gixg4_46">put()</code> method, and retrieve values using the <code class="code" id="-4gixg4_47">get()</code> method. You can use any Serializable object for either the key or the value.</p><div class="code-block" data-lang="none">
        String key;      // ...
        byte[] value;    // ...

        // Put the value into the cache.
        cache.put(key, value);

        // Get the value from the cache.
        value = (byte[]) cache.get(key);
</div><p id="-4gixg4_43">To put multiple values, you can call the <code class="code" id="-4gixg4_48">putAll()</code> method with a Map as its argument.</p><p id="-4gixg4_44">To remove a value from the cache (to evict it immediately), call the <code class="code" id="-4gixg4_49">remove()</code> method with the key as its argument. To remove every value from the cache for the application, call the <code class="code" id="-4gixg4_50">clear()</code> method.</p><p id="-4gixg4_45">The <code class="code" id="-4gixg4_51">containsKey()</code> method takes a key, and returns a <code class="code" id="-4gixg4_52">boolean</code> (<code class="code" id="-4gixg4_53">true</code> or <code class="code" id="-4gixg4_54">false</code>) to indicate whether a value with that key exists in the cache. The <code class="code" id="-4gixg4_55">isEmpty()</code> method tests whether the cache is empty. The <code class="code" id="-4gixg4_56">size()</code> method returns the number of values currently in the cache.</p></section><section class="chapter"><h2 id="configuring-expiration" data-toc="configuring-expiration">Configuring Expiration</h2><p id="-4gixg4_57">By default, all values remain in the cache as long as possible, until evicted due to memory pressure, removed explicitly by the app, or made unavailable for another reason (such as an outage). The app can specify a expiration time for values, a maximum amount of time the value will be available. The expiration time can be set as an amount of time relative to when the value is set, or as an absolute date and time.</p><p id="-4gixg4_58">You specify the expiration policy using configuration properties when you create the Cache instance. All values put with that instance use the same expiration policy. For example, to configure a Cache instance to expire values one hour (3,600 seconds) after they are set:</p><div class="code-block" data-lang="none">
import java.util.HashMap;
import java.util.Map;
import javax.cache.Cache;
import javax.cache.CacheException;
import javax.cache.CacheFactory;
import javax.cache.CacheManager;
import javax.concurrent.TimeUnit;
import com.google.appengine.api.memcache.jsr107cache.GCacheFactory;

// ...
        Cache cache;
        try {
            CacheFactory cacheFactory = CacheManager.getInstance().getCacheFactory();
            Map properties = new HashMap&lt;&gt;();
            properties.put(GCacheFactory.EXPIRATION_DELTA, TimeUnit.HOURS.toSeconds(1));
            cache = cacheFactory.createCache(properties);
        } catch (CacheException e) {
            // ...
        }
</div><p id="-4gixg4_60">The following properties control value expiration:</p><ul class="list _bullet" id="-4gixg4_61"><li class="list__item" id="-4gixg4_62"><p id="-4gixg4_65"><code class="code" id="-4gixg4_66">GCacheFactory.EXPIRATION_DELTA</code>: expire values the given amount of time relative to when they are put, as an Integer number of seconds</p></li><li class="list__item" id="-4gixg4_63"><p id="-4gixg4_67"><code class="code" id="-4gixg4_68">GCacheFactory.EXPIRATION_DELTA_MILLIS</code>: expire values the given amount of time relative to when they are put, as an Integer number of milliseconds</p></li><li class="list__item" id="-4gixg4_64"><p id="-4gixg4_69"><code class="code" id="-4gixg4_70">GCacheFactory.EXPIRATION</code>: expire values at the given date and time, as a java.util.Date</p></li></ul></section><section class="chapter"><h2 id="configuring-the-set-policy" data-toc="configuring-the-set-policy">Configuring the Set Policy</h2><p id="-4gixg4_71">By default, setting a value in the cache adds the value if there is no value with the given key, and replaces a value if there is a value with the given key. You can configure the cache to only add (protect existing values) or only replace values (do not add).</p><div class="code-block" data-lang="none">
import java.util.HashMap;
import java.util.Map;
import com.google.appengine.api.memcache.MemcacheService;

// ...
        Map props = new HashMap&lt;&gt;();
        properties.put(MemcacheService.SetPolicy.ADD_ONLY_IF_NOT_PRESENT, true);
</div><p id="-4gixg4_73">The following properties control the set policy:</p><ul class="list _bullet" id="-4gixg4_74"><li class="list__item" id="-4gixg4_75"><p id="-4gixg4_78"><code class="code" id="-4gixg4_79">MemcacheService.SetPolicy.SET_ALWAYS</code>: add the value if no value with the key exists, replace an existing value if a value with the key exists; this is the default</p></li><li class="list__item" id="-4gixg4_76"><p id="-4gixg4_80"><code class="code" id="-4gixg4_81">MemcacheService.SetPolicy.ADD_ONLY_IF_NOT_PRESENT</code>: add the value if no value with the key exists, do nothing if the key exists</p></li><li class="list__item" id="-4gixg4_77"><p id="-4gixg4_82"><code class="code" id="-4gixg4_83">MemcacheService.SetPolicy.REPLACE_ONLY_IF_PRESENT</code>: do nothing if no value with the key exists, replace an existing value if a value with the key exists</p></li></ul></section><section class="chapter"><h2 id="cache-statistics" data-toc="cache-statistics">Cache Statistics</h2><p id="-4gixg4_84">The app can retrieve statistics about its own use of the cache. These statistics are useful for monitoring and tuning cache behavior. You access statistics using a CacheStatistics object, which you get by calling the Cache's <code class="code" id="-4gixg4_88">getCacheStatistics()</code> method.</p><p id="-4gixg4_85">Available statistics include the number of cache hits (gets for keys that existed), the number of cache misses (gets for keys that did not exist), and the number of values in the cache.</p><div class="code-block" data-lang="none">
import javax.cache.CacheStatistics;

// ...
        CacheStatistics stats = cache.getCacheStatistics();
        int hits = stats.getCacheHits();
        int misses = stats.getCacheMisses();
</div><p id="-4gixg4_87">The App Engine implementation does not support resetting the hit and miss counts. Hit and miss counts are maintained indefinitely, but may be reset due to transient conditions of the memcache servers.</p></section><section class="chapter"><h2 id="jcache-features-not-supported" data-toc="jcache-features-not-supported">JCache Features Not Supported</h2><p id="-4gixg4_89">The JCache listener API is partially supported for listeners that can execute during the processing of a app's API call, such as for onPut and onRemove listeners. Listeners that require background processing, like onEvict, are not supported.</p><p id="-4gixg4_90">An app can test whether the cache contains a given key, but it cannot test whether the cache contains a given value (<code class="code" id="-4gixg4_94">containsValue()</code> is not supported).</p><p id="-4gixg4_91">An app cannot dump the contents of the cache's keys or values.</p><p id="-4gixg4_92">An app cannot manually reset cache statistics.</p><p id="-4gixg4_93">The <code class="code" id="-4gixg4_95">put()</code> method does not return the previous known value for a key. It always returns <code class="code" id="-4gixg4_96">null</code>.</p></section><section class="chapter"><h2 id="features-of-the-low-level-api" data-toc="features-of-the-low-level-api">Features of the Low-level API</h2><p id="-4gixg4_97">The low-level Memcache API includes a number of additional features such as:</p><ul class="list _bullet" id="-4gixg4_98"><li class="list__item" id="-4gixg4_100"><p id="-4gixg4_104">Atomically increment and decrement integer counter values</p></li><li class="list__item" id="-4gixg4_101"><p id="-4gixg4_105">Expose more cache statistics, such as the amount of time since the least-recently-used entry was accessed, and the total size of all items in the cache.</p></li><li class="list__item" id="-4gixg4_102"><p id="-4gixg4_106">Check and set operations to conditionally store data</p></li><li class="list__item" id="-4gixg4_103"><p id="-4gixg4_107">Perform memcache operations asynchronously, using the <a href="https://web.archive.org/web/20160424230647/https://cloud.google.com/appengine/docs/java/javadoc/com/google/appengine/api/memcache/AsyncMemcacheService" id="-4gixg4_108" data-external="true" rel="noopener noreferrer" target="_blank">AsyncMemcacheService</a>.</p></li></ul><p id="-4gixg4_99">For more information on the low-level API, see the <a href="https://web.archive.org/web/20160424230647/https://cloud.google.com/appengine/docs/java/javadoc/com/google/appengine/api/memcache/package-summary" id="-4gixg4_109" data-external="true" rel="noopener noreferrer" target="_blank">Memcache Javadoc</a>.</p></section><div class="last-modified">10 April 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="memcache-java-api-overview.html" class="navigation-links__prev">Memcache Java API Overview</a><a href="connecting-to-and-from-your-app.html" class="navigation-links__next">Connecting to and from Your App</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>