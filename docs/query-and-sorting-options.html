<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-07-13T01:56:45.168585636"><title>Query and Sorting Options | Google App Engine Java Documentation</title><script type="application/json" id="virtual-toc-data">[{"id":"searching-with-the-query-class","level":0,"title":"Searching with the Query class","anchor":"#searching-with-the-query-class"},{"id":"queryoptions","level":0,"title":"QueryOptions","anchor":"#queryoptions"},{"id":"sortoptions","level":0,"title":"SortOptions","anchor":"#sortoptions"},{"id":"writing-expressions","level":0,"title":"Writing expressions","anchor":"#writing-expressions"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Query and Sorting Options | Google App Engine Java Documentation"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Google App Engine Java Documentation Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/query-and-sorting-options.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Query and Sorting Options | Google App Engine Java Documentation"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/query-and-sorting-options.html#webpage",
    "url": "writerside-documentation/query-and-sorting-options.html",
    "name": "Query and Sorting Options | Google App Engine Java Documentation",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Google App Engine Java Documentation Help"
}</script><!-- End Schema.org --></head><body data-id="Query-and-Sorting-Options" data-main-title="Query and Sorting Options" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Guides.md|Guides///Searchable-Document-Indexes.md|Searchable Document Indexes"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Google App Engine Java Documentation  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Query-and-Sorting-Options" id="Query-and-Sorting-Options.md">Query and Sorting Options</h1><p id="-z4b3rx_3">When you call the <code class="code" id="-z4b3rx_12">search()</code> method using a query string alone, the results are returned according to the default query options:</p><ul class="list _bullet" id="-z4b3rx_4"><li class="list__item" id="-z4b3rx_13"><p id="-z4b3rx_16">Documents are returned sorted in order of descending rank</p></li><li class="list__item" id="-z4b3rx_14"><p id="-z4b3rx_17">Documents are returned in groups of 20 at a time</p></li><li class="list__item" id="-z4b3rx_15"><p id="-z4b3rx_18">Retrieved documents contain all of their original fields</p></li></ul><p id="-z4b3rx_5">You can use an instance of the <a href="https://web.archive.org/web/20160424230739/https://cloud.google.com/appengine/docs/java/javadoc/com/google/appengine/api/search/Query" id="-z4b3rx_19" data-external="true" rel="noopener noreferrer" target="_blank">Query</a> class as the argument to <code class="code" id="-z4b3rx_20">search()</code> to change these options. The Query class allows you to specify how many documents to return at a time. It also lets you customize the contents of the retrieved documents. You can ask for document identifiers only, or request that documents contain only a subset of their fields. You can also create custom fields in the retrieved documents: <span id="-z4b3rx_21">snippets</span> (fragments of text fields showing the text surrounding a matched string), and <span id="-z4b3rx_22">field expressions</span> (fields with values derived from other fields in the document).</p><p id="-z4b3rx_6">Apart from the query options, the Query class can also include an instance of the <code class="code" id="-z4b3rx_23">SortOptions</code> class. Using sort options you can change the sort order, and sort the results on multiple keys.</p><ol class="list _decimal" id="-z4b3rx_7" type="1"><li class="list__item" id="-z4b3rx_24"><p id="-z4b3rx_28"><span id="-z4b3rx_29">Searching with the Query class</span></p></li><li class="list__item" id="-z4b3rx_25"><p id="-z4b3rx_30"><span id="-z4b3rx_31">QueryOptions</span></p></li><li class="list__item" id="-z4b3rx_26"><p id="-z4b3rx_32"><span id="-z4b3rx_33">SortOptions</span></p></li><li class="list__item" id="-z4b3rx_27"><p id="-z4b3rx_34"><span id="-z4b3rx_35">Writing expressions</span></p></li></ol><section class="chapter"><h2 id="searching-with-the-query-class" data-toc="searching-with-the-query-class">Searching with the Query class</h2><p id="-z4b3rx_36">When you search with an instance of the Query class, you need to construct an instance of the class in several steps. This is the general order:</p><ol class="list _decimal" id="-z4b3rx_37" type="1"><li class="list__item" id="-z4b3rx_40"><p id="-z4b3rx_45">Create a query string.</p></li><li class="list__item" id="-z4b3rx_41"><p id="-z4b3rx_46">Create <code class="code" id="-z4b3rx_47">SortOptions</code> if needed.</p></li><li class="list__item" id="-z4b3rx_42"><p id="-z4b3rx_48">Create <code class="code" id="-z4b3rx_49">QueryOptions</code>.</p></li><li class="list__item" id="-z4b3rx_43"><p id="-z4b3rx_50">Create a Query object that includes the query string and the (optional) <code class="code" id="-z4b3rx_51">QueryOptions</code>.</p></li><li class="list__item" id="-z4b3rx_44"><p id="-z4b3rx_52">Call the search method on the Query object.</p></li></ol><p id="-z4b3rx_38">The various query and sort options are specified by calling setter methods on instances of the <code class="code" id="-z4b3rx_53">QueryOptions.Builder</code> and <code class="code" id="-z4b3rx_54">SortOptions.Builder</code> classes, as in this example:</p><div class="code-block" data-lang="none">
import com.google.appengine.api.search.Index;
import com.google.appengine.api.search.IndexSpec;
import com.google.appengine.api.search.SearchServiceFactory;
import com.google.appengine.api.search.Query;
import com.google.appengine.api.search.QueryOptions;
import com.google.appengine.api.search.Results;
import com.google.appengine.api.search.SearchException;
import com.google.appengine.api.search.SortExpression;
import com.google.appengine.api.search.SortOptions;
import com.google.appengine.api.search.ScoredDocument;

try {
    // Build the SortOptions with 2 sort keys
    SortOptions sortOptions = SortOptions.newBuilder()
        .addSortExpression(SortExpression.newBuilder()
            .setExpression(&quot;price&quot;)
            .setDirection(SortExpression.SortDirection.DESCENDING)
            .setDefaultValueNumeric(0))
        .addSortExpression(SortExpression.newBuilder()
            .setExpression(&quot;brand&quot;)
            .setDirection(SortExpression.SortDirection.DESCENDING)
            .setDefaultValue(&quot;&quot;))
        .setLimit(1000)
        .build();

    // Build the QueryOptions
    QueryOptions options = QueryOptions.newBuilder()
        .setLimit(25)
        .setFieldsToReturn(&quot;model&quot;, &quot;price&quot;, &quot;description&quot;)
        .setSortOptions(sortOptions)
        .build();

    // A query string
    String queryString = &quot;product: piano AND price &lt; 5000&quot;;

    //  Build the Query and run the search
    Query query = Query.newBuilder().setOptions(options).build(queryString);
    IndexSpec indexSpec = IndexSpec.newBuilder().setName(indexName).build();
    Index index = SearchServiceFactory.getSearchService().getIndex(indexSpec);
    Results&lt;ScoredDocument&gt; result =  index.search(query);
} catch (SearchException e) {
    // handle exception...
}
</div></section><section class="chapter"><h2 id="queryoptions" data-toc="queryoptions">QueryOptions</h2><p id="-z4b3rx_55">You must use the <a href="https://web.archive.org/web/20160424230739/https://cloud.google.com/appengine/docs/java/javadoc/com/google/appengine/api/search/QueryOptions.Builder" id="-z4b3rx_60" data-external="true" rel="noopener noreferrer" target="_blank"><code class="code" id="-z4b3rx_61">QueryOptions.Builder</code></a> to set query options. You do not have access to these properties directly.</p><p id="-z4b3rx_56">These properties control how many results are returned and in what order. The offset and cursor options, which are mutually exclusive, support pagination. They specify which selected documents to return in the results.</p><div class="table-wrapper"><table class="wide" id="-z4b3rx_57"><thead><tr class="ijRowHead" id="-z4b3rx_63"><th id="-z4b3rx_73"><p>Property</p></th><th id="-z4b3rx_74"><p>Description</p></th><th id="-z4b3rx_75"><p>Default</p></th><th id="-z4b3rx_76"><p>Maximum</p></th></tr></thead><tbody><tr id="-z4b3rx_64"><td id="-z4b3rx_77"><p><code class="code" id="-z4b3rx_81">Limit</code></p></td><td id="-z4b3rx_78"><p>The maximum number of documents to return in the results.</p></td><td id="-z4b3rx_79"><p>20</p></td><td id="-z4b3rx_80"><p>1000</p></td></tr><tr id="-z4b3rx_65"><td id="-z4b3rx_82"><p><code class="code" id="-z4b3rx_86">NumberFoundAccuracy</code></p></td><td id="-z4b3rx_83"><p>This property determines the accuracy of the result returned by <a href="https://web.archive.org/web/20160424230739/https://cloud.google.com/appengine/docs/java/javadoc/com/google/appengine/api/search/Results#getNumberFound()" id="-z4b3rx_87" data-external="true" rel="noopener noreferrer" target="_blank"><code class="code" id="-z4b3rx_90">Results.getNumberFound()</code></a>. It sets a limit for how many matches are actually counted, stopping the search when the limit is reached. <br><br> If the number of matches in the index is less than or equal to the limit, the count returned is exact. Otherwise, the count is an estimate based on the matches that were found and the size and structure of the index. Note that setting a high value for this property can affect the complexity of the search operation and may cause timeouts.</p></td><td id="-z4b3rx_84"><p>If unspecified accuracy is set to the same value as <code class="code" id="-z4b3rx_91">Limit</code></p></td><td id="-z4b3rx_85"><p>25000</p></td></tr><tr id="-z4b3rx_66"><td id="-z4b3rx_92"><p><code class="code" id="-z4b3rx_96">Offset</code></p></td><td id="-z4b3rx_93"><p>The offset of the first document in the results to return.</p></td><td id="-z4b3rx_94"><p>0. Results will contain all matching documents (up to limit).</p></td><td id="-z4b3rx_95"><p>1,000</p></td></tr><tr id="-z4b3rx_67"><td id="-z4b3rx_97"><p><code class="code" id="-z4b3rx_101">Cursor</code></p></td><td id="-z4b3rx_98"><p>A cursor can be used in lieu of an offset to retrieve groups of documents in sorted order. A cursor is updated as it is passed into and out of consecutive queries, allowing each new search to be continued from the end of the previous one. Cursor and offset are discussed on the <a href="https://web.archive.org/web/20160424230739/https://cloud.google.com/appengine/docs/java/search/results" id="-z4b3rx_102" data-external="true" rel="noopener noreferrer" target="_blank">Handling Results</a> page.</p></td><td id="-z4b3rx_99"><p>Null. Results will contain all matching documents (up to limit).</p></td><td id="-z4b3rx_100"><p>-</p></td></tr><tr id="-z4b3rx_68"><td id="-z4b3rx_103"><p><code class="code" id="-z4b3rx_107">SortOptions</code></p></td><td id="-z4b3rx_104"><p>Set a <code class="code" id="-z4b3rx_108">SortOptions</code> object to control the ordering of the search results. An instance of <code class="code" id="-z4b3rx_109">SortOptions</code> has its own set of properties which are described below.</p></td><td id="-z4b3rx_105"><p>Null. Sort by decreasing document rank.</p></td><td id="-z4b3rx_106"><p>-</p></td></tr></tbody></table></div><p id="-z4b3rx_58">These properties control what document fields appear in the results.</p><div class="table-wrapper"><table class="wide" id="-z4b3rx_59"><thead><tr class="ijRowHead" id="-z4b3rx_111"><th id="-z4b3rx_119"><p>Property</p></th><th id="-z4b3rx_120"><p>Description</p></th><th id="-z4b3rx_121"><p>Default</p></th></tr></thead><tbody><tr id="-z4b3rx_112"><td id="-z4b3rx_122"><p><code class="code" id="-z4b3rx_125">ReturningIdsOnly</code></p></td><td id="-z4b3rx_123"><p>Set to <code class="code" id="-z4b3rx_126">True</code> or <code class="code" id="-z4b3rx_127">False</code>. When <code class="code" id="-z4b3rx_128">True</code>, the documents returned in the results will contain IDs only, no fields.</p></td><td id="-z4b3rx_124"><p><code class="code" id="-z4b3rx_129">False</code> (return all fields).</p></td></tr><tr id="-z4b3rx_113"><td id="-z4b3rx_130"><p><code class="code" id="-z4b3rx_133">FieldsToReturn</code></p></td><td id="-z4b3rx_131"><p>Specifies which document fields to include in the results. No more than 100 fields can be specified.</p></td><td id="-z4b3rx_132"><p>Return all document fields (up to 100 fields).</p></td></tr><tr id="-z4b3rx_114"><td id="-z4b3rx_134"><p><code class="code" id="-z4b3rx_137">ExpressionsToReturn</code></p></td><td id="-z4b3rx_135"><p>Field expressions describing computed fields that are added to each document returned in the search results. These fields are added to the expressions property of the document. The field value is specified by <span id="-z4b3rx_138">writing an expression</span> which may include one or more document fields.</p></td><td id="-z4b3rx_136"><p>None</p></td></tr><tr id="-z4b3rx_115"><td id="-z4b3rx_139"><p><code class="code" id="-z4b3rx_142">FieldsToSnippet</code></p></td><td id="-z4b3rx_140"><p>A list of text field names. A <span id="-z4b3rx_143">snippet</span> is generated for each field. This is a computed field that is added to the expressions property of the documents in the search results. The snippet field has the same name as its source field. <br><br> This option implicitly uses the snippet function with only two arguments, creating a snippet with at most one matching string, based on the same query string that the search used to retrieve the results: <code class="code" id="-z4b3rx_146">snippet(&quot;query-string&quot;, field-name)</code>. <br><br> You can also create customized snippets with the <code class="code" id="-z4b3rx_149">ExpressionsToReturn</code> option by adding a field expression that explicitly calls the <span id="-z4b3rx_150">snippet function</span>.</p></td><td id="-z4b3rx_141"><p>None</p></td></tr></tbody></table></div></section><section class="chapter"><h2 id="sortoptions" data-toc="sortoptions">SortOptions</h2><p id="-z4b3rx_151">The properties of <code class="code" id="-z4b3rx_157">SortOptions</code> control the ordering and scoring of the search results. You must use the <a href="https://web.archive.org/web/20160424230739/https://cloud.google.com/appengine/docs/java/javadoc/com/google/appengine/api/search/SortOptions.Builder" id="-z4b3rx_158" data-external="true" rel="noopener noreferrer" target="_blank"><code class="code" id="-z4b3rx_159">SortOptions.Builder</code></a> to set the sort options. You do not have access to these properties directly.</p><p id="-z4b3rx_152">The properties of <code class="code" id="-z4b3rx_160">SortOptions</code> control the ordering and scoring of the search results.</p><div class="table-wrapper"><table class="wide" id="-z4b3rx_153"><thead><tr class="ijRowHead" id="-z4b3rx_161"><th id="-z4b3rx_165"><p>Property</p></th><th id="-z4b3rx_166"><p>Description</p></th><th id="-z4b3rx_167"><p>Default</p></th></tr></thead><tbody><tr id="-z4b3rx_162"><td id="-z4b3rx_168"><p><code class="code" id="-z4b3rx_171">SortExpressions</code></p></td><td id="-z4b3rx_169"><p>A list of <span id="-z4b3rx_172"><code class="code" id="-z4b3rx_173">SortExpressions</code></span> representing a multi-dimensional sort of Documents.</p></td><td id="-z4b3rx_170"><p>None</p></td></tr><tr id="-z4b3rx_163"><td id="-z4b3rx_174"><p><code class="code" id="-z4b3rx_177">MatchScorer</code></p></td><td id="-z4b3rx_175"><p>An optional <a href="https://web.archive.org/web/20160424230739/https://cloud.google.com/appengine/docs/java/javadoc/com/google/appengine/api/search/MatchScorer" id="-z4b3rx_178" data-external="true" rel="noopener noreferrer" target="_blank"><code class="code" id="-z4b3rx_180">MatchScorer</code></a> object. When present this will cause the documents to be scored according to search term frequency. The score will be available as the <code class="code" id="-z4b3rx_179">_score</code> field. Scoring documents can be expensive (in both billable operations and execution time) and can slow down your searches. Use scoring sparingly.</p></td><td id="-z4b3rx_176"><p>None</p></td></tr><tr id="-z4b3rx_164"><td id="-z4b3rx_181"><p><code class="code" id="-z4b3rx_184">Limit</code></p></td><td id="-z4b3rx_182"><p>Maximum number of objects to score and/or sort. Cannot be more than 10,000.</p></td><td id="-z4b3rx_183"><p>1,000</p></td></tr></tbody></table></div><section class="chapter"><h3 id="sorting-on-multiple-keys" data-toc="sorting-on-multiple-keys">Sorting on multiple keys</h3><p id="-z4b3rx_185">You can order the search results on multiple sort keys. Each key can be a simple field name, or a value that is computed from several fields. Note that the term 'expression' is used with multiple meanings when speaking about sort options: The <code class="code" id="-z4b3rx_188">SortOption</code> itself has an <span class="emphasis" id="-z4b3rx_189">expressions attribute</span>. This attribute is a list of <code class="code" id="-z4b3rx_190">SortExpression</code> objects which correspond to sort keys. Finally, each <code class="code" id="-z4b3rx_191">SortExpression</code> object contains an <span class="emphasis" id="-z4b3rx_192">expression attribute</span> which specifies how to calculate the value of the sort key. This expression is constructed according to the rules in the next section.</p><p id="-z4b3rx_186">A <code class="code" id="-z4b3rx_193">SortExpression</code> also defines the direction of the sort and a default key value to use if the expression cannot be calculated for a document. Here is the complete list of properties:</p><div class="table-wrapper"><table class="wide" id="-z4b3rx_187"><thead><tr class="ijRowHead" id="-z4b3rx_195"><th id="-z4b3rx_202"><p>Property</p></th><th id="-z4b3rx_203"><p>Description</p></th><th id="-z4b3rx_204"><p>Default</p></th></tr></thead><tbody><tr id="-z4b3rx_196"><td id="-z4b3rx_205"><p><code class="code" id="-z4b3rx_208">Expression</code></p></td><td id="-z4b3rx_206"><p>An expression to be evaluated when sorting results for each matching document.</p></td><td id="-z4b3rx_207"><p>None</p></td></tr><tr id="-z4b3rx_197"><td id="-z4b3rx_209"><p><code class="code" id="-z4b3rx_212">Direction</code></p></td><td id="-z4b3rx_210"><p>The direction to sort the search results, either <code class="code" id="-z4b3rx_213">ASCENDING</code> or <code class="code" id="-z4b3rx_214">DESCENDING</code>.</p></td><td id="-z4b3rx_211"><p><code class="code" id="-z4b3rx_215">DESCENDING</code></p></td></tr><tr id="-z4b3rx_198"><td id="-z4b3rx_216"><p><code class="code" id="-z4b3rx_219">DefaultValue</code><br> <code class="code" id="-z4b3rx_221">DefaultValueDate</code><br> <code class="code" id="-z4b3rx_223">DefaultValueNumber</code></p></td><td id="-z4b3rx_217"><p>The default value of the expression, if no field is present and cannot be calculated for a document. A text value must be specified for text sorts. A numeric value must be specified for numeric sorts.</p></td><td id="-z4b3rx_218"><p>None</p></td></tr></tbody></table></div></section><section class="chapter"><h3 id="sorting-on-multi-valued-fields" data-toc="sorting-on-multi-valued-fields">Sorting on multi-valued fields</h3><p id="-z4b3rx_224">When you sort on a multi-valued field of a particular type, only the first value assigned to the field is used. For example, consider two documents, DocA and DocB that both have a text field named &ldquo;color&rdquo;. Two values are assigned to the DocA &ldquo;color&rdquo; field in the order (red, blue), and two values to DocB in the order (green, red). When you perform a sort specifying the text field &ldquo;color&rdquo;, DocA is sorted on the value &ldquo;red&rdquo; and DocB on the value &ldquo;green&rdquo;. The other field values are not used in the sort.</p></section><section class="chapter"><h3 id="to-sort-or-not-to-sort" data-toc="to-sort-or-not-to-sort">To sort or not to sort</h3><p id="-z4b3rx_225">If you do not specify any sort options, your search results are automatically returned sorted by descending rank. There is no limit to the number of documents that are returned in this case. If you specify any sorting options, the sort is performed after all the matching documents have been selected. There is an explicit property, <code class="code" id="-z4b3rx_226">SortOptions.limit</code>, that controls the size of the sort. You can never sort more than 10,000 docs, the default is 1,000. If there are more matching documents than the number specified by <code class="code" id="-z4b3rx_227">SortOptions.limit</code>, search only retrieves, sorts, and returns that limited number. It selects the documents to sort from the list of all matching documents, which is in descending rank order. It is possible that a query may select more matching documents than you can sort. If you are using sort options and it is important to retrieve every matching document, you should try to insure that your query will return no more documents than you can sort.</p></section></section><section class="chapter"><h2 id="writing-expressions" data-toc="writing-expressions">Writing expressions</h2><p id="-z4b3rx_228">Expressions are used to define field expressions (which are set in the <code class="code" id="-z4b3rx_236">QueryOptions</code>) and sort expressions (which are set in the <code class="code" id="-z4b3rx_237">SortOptions</code>). They are written as strings:</p><div class="code-block" data-lang="none">
&quot;price * quantity&quot;
&quot;(men + women)/2&quot;
&quot;min(daily_use, 10) * rate&quot;
&quot;snippet('rose', flower, 120)&quot;
</div><p id="-z4b3rx_230">Expressions involving Number fields can use the arithmetical operators (+, -, *, /) and the built-in numeric functions listed below. Expressions involving geopoint fields can use the geopoint and distance functions. Expressions for Text and HTML fields can use the snippet function.</p><p id="-z4b3rx_231">Expressions can also include these special terms:</p><div class="table-wrapper"><table class="wide" id="-z4b3rx_232"><thead><tr class="ijRowHead" id="-z4b3rx_238"><th id="-z4b3rx_241"><p>Term</p></th><th id="-z4b3rx_242"><p>Description</p></th></tr></thead><tbody><tr id="-z4b3rx_239"><td id="-z4b3rx_243"><p><code class="code" id="-z4b3rx_245">_rank</code></p></td><td id="-z4b3rx_244"><p>A document's <a href="https://web.archive.org/web/20160424230739/https://cloud.google.com/appengine/docs/java/search/#other_document_properties" id="-z4b3rx_246" data-external="true" rel="noopener noreferrer" target="_blank">rank</a> property. It can be used in field expressions and sort expressions.</p></td></tr><tr id="-z4b3rx_240"><td id="-z4b3rx_247"><p><code class="code" id="-z4b3rx_249">_score</code></p></td><td id="-z4b3rx_248"><p>The score assigned to a document when you include a <a href="https://web.archive.org/web/20160424230739/https://cloud.google.com/appengine/docs/java/javadoc/com/google/appengine/api/search/MatchScorer" id="-z4b3rx_250" data-external="true" rel="noopener noreferrer" target="_blank"><code class="code" id="-z4b3rx_252">MatchScorer</code></a> in the <code class="code" id="-z4b3rx_251">SortOptions</code>. This term can only appear in sort expressions; it cannot be used in field expressions.</p></td></tr></tbody></table></div><section class="chapter"><h3 id="numeric-functions" data-toc="numeric-functions">Numeric functions</h3><p id="-z4b3rx_253">The expressions to define numeric values for <code class="code" id="-z4b3rx_255">FieldExpressions</code> and <code class="code" id="-z4b3rx_256">SortExpressions</code> can use these built-in functions. The arguments must be numbers, field names, or expressions using numbers and field names.</p><div class="table-wrapper"><table class="wide" id="-z4b3rx_254"><thead><tr class="ijRowHead" id="-z4b3rx_257"><th id="-z4b3rx_264"><p>Function</p></th><th id="-z4b3rx_265"><p>Description</p></th><th id="-z4b3rx_266"><p>Example</p></th></tr></thead><tbody><tr id="-z4b3rx_258"><td id="-z4b3rx_267"><p><code class="code" id="-z4b3rx_270">max</code></p></td><td id="-z4b3rx_268"><p>Returns the largest of its arguments.</p></td><td id="-z4b3rx_269"><p><code class="code" id="-z4b3rx_271">max(recommended_retail_price, discount_price, wholesale_price)</code></p></td></tr><tr id="-z4b3rx_259"><td id="-z4b3rx_272"><p><code class="code" id="-z4b3rx_275">min</code></p></td><td id="-z4b3rx_273"><p>Returns the smallest of its arguments.</p></td><td id="-z4b3rx_274"><p><code class="code" id="-z4b3rx_276">min(height, width, length)</code></p></td></tr><tr id="-z4b3rx_260"><td id="-z4b3rx_277"><p><code class="code" id="-z4b3rx_280">log</code></p></td><td id="-z4b3rx_278"><p>Returns the natural logarithm.</p></td><td id="-z4b3rx_279"><p><code class="code" id="-z4b3rx_281">log(x)</code></p></td></tr><tr id="-z4b3rx_261"><td id="-z4b3rx_282"><p><code class="code" id="-z4b3rx_285">abs</code></p></td><td id="-z4b3rx_283"><p>Returns the absolute value.</p></td><td id="-z4b3rx_284"><p><code class="code" id="-z4b3rx_286">abs(x)</code></p></td></tr><tr id="-z4b3rx_262"><td id="-z4b3rx_287"><p><code class="code" id="-z4b3rx_290">pow</code></p></td><td id="-z4b3rx_288"><p>Takes two numeric arguments. The call pow(x, y) computes the value of x raised to the y power.</p></td><td id="-z4b3rx_289"><p><code class="code" id="-z4b3rx_291">pow(x, 2)</code></p></td></tr><tr id="-z4b3rx_263"><td id="-z4b3rx_292"><p><code class="code" id="-z4b3rx_295">count</code></p></td><td id="-z4b3rx_293"><p>Takes a field name as its argument. Returns the number of fields in the document with that name. Remember that a document can contain multiple fields of different types with the same name. Note: <code class="code" id="-z4b3rx_296">count</code> can only be used in <code class="code" id="-z4b3rx_297">FieldExpressions</code>. It cannot appear in <code class="code" id="-z4b3rx_298">SortExpressions</code>.</p></td><td id="-z4b3rx_294"><p><code class="code" id="-z4b3rx_299">count(user)</code></p></td></tr></tbody></table></div></section><section class="chapter"><h3 id="geopoint-functions" data-toc="geopoint-functions">Geopoint functions</h3><p id="-z4b3rx_300">These functions can be used for expressions involving geopoint fields.</p><div class="table-wrapper"><table class="wide" id="-z4b3rx_301"><thead><tr class="ijRowHead" id="-z4b3rx_302"><th id="-z4b3rx_305"><p>Function</p></th><th id="-z4b3rx_306"><p>Description</p></th><th id="-z4b3rx_307"><p>Example</p></th></tr></thead><tbody><tr id="-z4b3rx_303"><td id="-z4b3rx_308"><p><code class="code" id="-z4b3rx_311">geopoint</code></p></td><td id="-z4b3rx_309"><p>Defines a geopoint given a latitude and longitude.</p></td><td id="-z4b3rx_310"><p><code class="code" id="-z4b3rx_312">geopoint(-31.3, 151.4)</code></p></td></tr><tr id="-z4b3rx_304"><td id="-z4b3rx_313"><p><code class="code" id="-z4b3rx_316">distance</code></p></td><td id="-z4b3rx_314"><p>Computes the distance in meters between two geopoints. Note that either of the two arguments can be the name of a geopoint field or an invocation of the geopoint function. However, only one argument can be a field name.</p></td><td id="-z4b3rx_315"><p><code class="code" id="-z4b3rx_317">distance(geopoint(23, 134), store_location)</code></p></td></tr></tbody></table></div></section><section class="chapter"><h3 id="snippets" data-toc="snippets">Snippets</h3><p id="-z4b3rx_318">A snippet is a fragment of a text field that matches a query string and includes the surrounding text. Snippets are created by calling the <code class="code" id="-z4b3rx_323">snippet</code> function:</p><p id="-z4b3rx_319"><code class="code" id="-z4b3rx_324">snippet(query, body, [max_chars])</code></p><section class="chapter"><h4 id="query" data-toc="query"><code class="code" id="-z4b3rx_327">query</code></h4><p id="-z4b3rx_326">A quoted query string specifying the text to find in the field.</p></section><section class="chapter"><h4 id="body" data-toc="body"><code class="code" id="-z4b3rx_330">body</code></h4><p id="-z4b3rx_329">The name of a text, HTML, or atom field.</p></section><section class="chapter"><h4 id="max-chars" data-toc="max-chars"><code class="code" id="-z4b3rx_334">max_chars</code></h4><p id="-z4b3rx_332">The maximum number of characters to return in the snippet. This argument is optional; it defaults to 160 characters.</p><p id="-z4b3rx_333">The function returns an HTML string. The string contains a snippet of the body field's value, with the text that matched the query in boldface.</p></section></section></section><div class="last-modified">10 April 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="query-strings.html" class="navigation-links__prev">Query Strings</a><a href="handling-search-results.html" class="navigation-links__next">Handling Search Results</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>